$(document).ready(function(){var g=$("#aligned_outcomes .outcomes_url").attr("href"),h=function(a){$("#aligned_outcomes .outcomes .outcome:not(.blank)").remove();var b=parseFloat($("#full_assignment_holder input[name='assignment[mastery_score]']").val()),c=parseFloat($("#full_assignment_holder input[name='assignment[points_possible]']").val()),d=null;if(isFinite(b)||isFinite(c))d=b||c||0;for(var e in a){b=a[e].content_tag;c=b.learning_outcome;var f=$("#aligned_outcomes .outcomes .outcome.blank:first").clone(true).removeClass("blank");
c.mastery="";if(b.rubric_association_id){f.addClass("rubric_alignment");c.mastery="see the rubric for mastery details"}else if(d)c.mastery="mastery with a score of "+d+" or higher";f.fillTemplateData({data:c,hrefValues:["id"],htmlValues:["description"]});$("#aligned_outcomes .outcomes").append(f.show())}$("#aligned_outcomes").showIf(a.length>0);$("#align_outcomes_dialog:visible").length>0&&$(".align_outcomes_link:first").click()};typeof g!="undefined"&&$.ajaxJSON(g,"GET",{},function(a){h(a)});$(".align_outcomes_link").click(function(a){a.preventDefault();
$("#aligned_outcomes").show();$("html,body").scrollTo($("#aligned_outcomes"));a=(a=parseFloat($("#full_assignment_holder input[name='assignment[mastery_score]']").val()))||"";$("#align_outcomes_dialog .outcome_checkbox").each(function(){$(this).attr("checked",false).attr("disabled",false)});$("#align_outcomes_dialog .rubric_aligned").hide();$("#aligned_outcomes .outcomes .outcome:not(.blank):not(.rubric_alignment)").each(function(){var b=$(this).getTemplateData({textValues:["id"]}).id;$("#align_outcome_for_"+
b).attr("checked",true)});$("#aligned_outcomes .outcomes .outcome.rubric_alignment:not(.blank)").each(function(){var b=$(this).getTemplateData({textValues:["id"]}).id;$("#align_outcome_for_"+b).attr("checked",true).attr("disabled",true);$(this).parents(".outcome").find(".rubric_aligned").show()});$("#align_outcomes_dialog .outcome_checkbox").each(function(){$(this).change()});$("#aligned_outcomes_mastery_score").val(a);$("#align_outcomes_dialog").dialog("close").dialog({autoOpen:false,title:"Align Outcomes",
width:500}).dialog("open")});$("#align_outcomes_dialog .cancel_button").click(function(){$("#align_outcomes_dialog").dialog("close")});$("#align_outcomes_dialog .outcome_checkbox").change(function(){$(this).parents(".outcome").toggleClass("selected_outcome",$(this).attr("checked"))});$("#align_outcomes_dialog .save_button").click(function(){var a=[];$(".outcome_checkbox:checked").each(function(){a.push($(this).val())});a=a.join(",");var b=$("#aligned_outcomes .outcomes_url").attr("href"),c=parseFloat($("#aligned_outcomes_mastery_score").val())||
"",d=$(this);d.text("Aligning Outcomes...");$("#align_outcomes_dialog .button-container .button").attr("disabled",true);$.ajaxJSON(b,"POST",{outcome_ids:a,mastery_score:c},function(e){$("#align_outcomes_dialog .button-container .button").attr("disabled",false);d.text("Align Outcomes");$("#full_assignment_holder input[name='assignment[mastery_score]']").val(c);h(e);$("#align_outcomes_dialog").dialog("close")},function(){$("#align_outcomes_dialog .button-container .button").attr("disabled",false);d.text("Align Outcomes Failed, Please Try Again")})})});
