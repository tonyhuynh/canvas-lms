var calendarMonths=function(){function c(d){return{day:d.getDate(),month:d.getMonth(),year:d.getFullYear()}}var q=["January","February","March","April","May","June","July","August","September","October","November","December"];return{changeMonth:function(d,h){d.data("calendar_objects");var j={},e=null;if(typeof h=="string")(e=$.datepicker.parseDate("mm/dd/yy",h))&&e.setDate(1);if(!e){var a=parseInt(d.find(".month_number").text(),10),g=parseInt(d.find(".year_number").text(),10);e=new Date(g,a+h-1,1)}j=
{month_name:q[e.getMonth()],month_number:e.getMonth()+1,year_number:e.getFullYear()};d.fillTemplateData({data:j});a=new Date;j=c(a);var k=c(e);a=e;a.setDate(0);a.setDate(a.getDate()-a.getDay());g=c(a);var b=null;if(k.day!=g.day){a.setDate(1);a.setMonth(a.getMonth()+1);a.setDate(0);b={day:a.getDate(),month:g.month,year:g.year};a.setDate(1);a.setMonth(a.getMonth()+1)}a.setMonth(e.getMonth()+1);a.setDate(0);e={day:a.getDate(),month:k.month,year:k.yearh};a.setDate(a.getDate()+1);a.setDate(a.getDate()+
(6-a.getDay()));a.setDate(a.getDate()+7);var i=c(a),f=d.data("days");if(!f){f=d.find(".calendar_day_holder");d.data("days",f)}if(d.hasClass("mini_month"))f=d.find(".day");d.find(".calendar_event").remove();var o=0,m=g.day;a=g.month;for(g=g.year;m<=i.day||a!=i.month;){var n=f.eq(o);if(n.length>0){for(var l=n.attr("class").split(" "),p=[],r=0;r<l.length;r++)l[r].indexOf("date_")!=0&&p.push(l[r]);n.attr("class",p.join(" "))}n.show().addClass("visible").parents("tr").show().addClass("visible");l=a<9?
"0"+(a+1):a+1;p=m<10?"0"+m:m;id="day_"+g+"_"+l+"_"+p;if(d.hasClass("mini_month"))id="mini_"+id;n.attr("id",id).find(".day_number").text(m).attr("title",l+"/"+p+"/"+g).addClass("date_"+l+"_"+p+"_"+g);l=n.children("div");if(d.hasClass("mini_month"))l=n;l.removeClass("current_month other_month today");a==k.month?l.addClass("current_month"):l.addClass("other_month");a==j.month&&m==j.day&&g==j.year&&l.addClass("today");m++;o++;if(b&&m>b.day&&a==b.month||m>e.day&&a==e.month){a+=1;if(a>=12){a-=12;g++}m=
1}}for(;o<f.length;){n=f.eq(o);n.parents("tr").hide().removeClass("visible");n.hide().removeClass("visible");o++}d.hasClass("mini_month")}}}(),wikiSidebar;
jQuery(function(c){function q(){k.find(".day.has_event").removeClass("has_event");g.find("tr.date").each(function(){var b=c(this).find(".day_date").attr("title").split("/"),i=b.join("_");b=[b[2],b[0],b[1]].join("_");k.find(".mini_calendar_day.date_"+i+", #mini_day_"+b).addClass("has_event")})}function d(b,i){c("tr.date.related,.day.related").removeClass("related");if(b){var f=i.split("/"),o=f.join("_");f=[f[2],f[0],f[1]].join("_");k.find(".mini_calendar_day.date_"+o+", #mini_day_"+f).add(g.find("tr.date.events_"+
o)).addClass("related")}}var h=c("#edit_course_syllabus_form"),j=c("#course_syllabus_body"),e=c("#course_syllabus"),a=c("#course_syllabus_details"),g=c("#syllabus"),k=c(".mini_month");k.find(".next_month_link, .prev_month_link").bind("mousedown",function(b){b.preventDefault();calendarMonths.changeMonth(k,c(this).hasClass("next_month_link")?1:-1);q()}).bind("click",false);k.delegate(".mini_calendar_day","click",function(b){b.preventDefault();var i=c(this).find(".day_number").attr("title");calendarMonths.changeMonth(k,
i);q();c(".events_"+i.replace(/\//g,"_")).ifExists(function(f){c("html,body").scrollTo(f);d(true,i)})}).delegate(".mini_calendar_day","mouseover mouseout",function(b){d(b.type==="mouseover",c(this).find(".day_number").attr("title"))});g.delegate("tr.date","mouseenter mouseleave",function(b){d(b.type==="mouseenter",c(this).find(".day_date").attr("title"))});c(".jump_to_today_link").click(function(b){b.preventDefault();var i=c.datepicker.formatDate("mm/dd/yy",new Date),f;c("tr.date").each(function(){if(c(this).find(".day_date").attr("title")>
i)return false;f=c(this)});calendarMonths.changeMonth(k,i);c("html,body").scrollTo(f||c("tr.date:first"));d(true,i)});wikiSidebar&&wikiSidebar.init();h.bind("edit",function(){h.show();e.hide();a.hide();j.editorBox();j.editorBox("set_code",e.html());if(wikiSidebar){wikiSidebar.attachToEditor(j);wikiSidebar.show();c("#sidebar_content").hide()}});h.bind("hide_edit",function(){h.hide();e.show();var b=c.trim(e.html());a.showIf(!b);j.editorBox("destroy");c("#sidebar_content").show();wikiSidebar&&wikiSidebar.hide()});
c(".edit_syllabus_link").click(function(b){b.preventDefault();c("#edit_course_syllabus_form").triggerHandler("edit")});h.find(".toggle_views_link").click(function(b){b.preventDefault();j.editorBox("toggle")});h.find(".cancel_button").click(function(b){h.triggerHandler("hide_edit");b.preventDefault()});h.formSubmit({object_name:"course",processData:function(b){b["course[syllabus_body]"]=j.editorBox("get_code");return b},beforeSubmit:function(b){e.html(b["course[syllabus_body]"]);h.triggerHandler("hide_edit");
a.hide();e.loadingImage()},success:function(b){e.loadingImage("remove").html(b.course.syllabus_body);a.hide()},error:function(b){h.triggerHandler("edit").formErrors(b)}});c.scrollSidebar();q()});
