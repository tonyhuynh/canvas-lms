$(document).ready(function(){$("#outcome_results").pageless({totalPages:parseInt($("#outcome_results_total_pages").text(),10)||1,url:$(".outcome_results_url").attr("href"),loaderMsg:"Loading more results",scrape:function(a){if(typeof a=="string")try{a=JSON.parse(a)}catch(b){a=[]}for(var c in a){var d=a[c].learning_outcome_result,e=$("#result_blank").clone(true).attr("id","result_"+d.id);d.assessed_at_formatted=$.parseFromISO(d.assessed_at).datetime_formatted;e.toggleClass("mastery_result",!!d.mastery);
e.fillTemplateData({data:d,except:["mastery"]});$("#outcome_results_list").append(e);e.show()}return""}});$(".delete_alignment_link").click(function(a){a.preventDefault();$(this).parents(".alignment").confirmDelete({url:$(this).attr("href"),message:"Are you sure you want to remove this alignment?",success:function(){$(this).slideUp(function(){$(this).remove()})}})});$("#alignments").sortable({axis:"y",handle:".move_alignment_link",update:function(){var a=[];$("#alignments .alignment").each(function(){a.push($(this).getTemplateData({textValues:["id"]}).id)});
var b=$("#outcome_urls .reorder_alignments_url:last").attr("href");$.ajaxJSON(b,"POST",{order:a.join(",")},function(){},function(){})}});var f=function(a){a.title=a["item[title]"]||a.title;var b=$("#alginment_"+a.id);if(b.length===0)b=$("#alignment_blank").clone(true).removeAttr("id");b.addClass($.underscore(a.content_type));var c=$.titleize(a.content_type)||"Alignment";b.find(".type_icon").attr("alt",c).attr("title",c);b.attr("id","alignment_"+(a.id||"new"));c=["user_id"];if(a.id)c=["user_id","id"];
b.fillTemplateData({data:a,hrefValues:c});$("#alignments").append(b.show());return b};$(".add_outcome_alignment_link").live("click",function(a){a.preventDefault();if(INST&&INST.selectContentDialog){a={for_modules:false};a.select_button_text="Align Item";a.holder_name="this Outcome";a.dialog_title="Align Item to this Outcome";a.submit=function(b){var c=f(b),d=$("#outcome_urls .align_url").attr("href");b.asset_string=b["item[type]"]+"_"+b["item[id]"];c.loadingImage({image_size:"small"});$.ajaxJSON(d,
"POST",b,function(e){c.loadingImage("remove");c.remove();f(e.content_tag);$("#alignments").sortable("refresh")})};INST.selectContentDialog(a)}});$("#artifacts li").live("mouseover",function(){$(".hover_alignment,.hover_artifact").removeClass("hover_alignment").removeClass("hover_artifact");$(this).addClass("hover_artifact")});$("#alignments li").live("mouseover",function(){$(".hover_alignment,.hover_artifact").removeClass("hover_alignment").removeClass("hover_artifact");$(this).addClass("hover_alignment")})});
