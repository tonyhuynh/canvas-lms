$(document).ready(function(){$("#add_collaboration_form").submit(function(a){if(!$(this).getFormData()["collaboration[title]"]){a.preventDefault();a.stopPropagation();$(this).find("#collaboration_title").errorBox("Please enter a name for this document");$("html,body").scrollTo($(this));return false}setTimeout(function(){window.location=window.location.href.replace(window.location.hash,"")},2500)});$(".toggle_collaborators_link").live("click",function(){$(this).parents(".collaboration").find(".collaborators").slideToggle()});
$(".add_collaboration_link").click(function(a){a.preventDefault();$(this).hide();$("#add_collaboration_form").slideToggle(function(){$("html,body").scrollTo($(this));$(this).find(":text:visible:first").focus().select()})});$("#add_collaboration_form .cancel_button").click(function(){$(".add_collaboration_link").show();$("#add_collaboration_form").slideToggle()});$("#delete_collaboration_dialog .cancel_button").click(function(){$("#delete_collaboration_dialog").dialog("close")});$("#delete_collaboration_dialog .delete_button").click(function(){$(this).hasClass("delete_document_button");
var a=$("#delete_collaboration_dialog").data("collaboration"),b=a.find(".delete_collaboration_link").attr("href");a.dim();$("#delete_collaboration_dialog").dialog("close");$.ajaxJSON(b,"DELETE",function(){a.slideUp(function(){$(this).remove()})},function(){})});$(".delete_collaboration_link").click(function(a){a.preventDefault();a=$(this).parents(".collaboration");if($(this).parents(".collaboration").hasClass("google_docs")){$("#delete_collaboration_dialog").data("collaboration",a);$("#delete_collaboration_dialog").dialog("close").dialog({autoOpen:false,
title:"Delete Collaboration?",width:350}).dialog("open")}else a.confirmDelete({message:"Are you sure you want to delete this collaboration?",url:$(this).attr("href"),success:function(){$("#collaborations .collaboration:visible").length<=1&&$("#no_collaborations_message").slideDown();$(this).slideUp(function(){$(this).remove()})}})});$(".edit_collaboration_link").click(function(a){a.preventDefault();a=$("#edit_collaboration_form").clone(true);a.attr("action",$(this).attr("href"));var b=$(this).parents(".collaboration");
a.attr("class",b.attr("class"));var c=[],d=b.getTemplateData({textValues:["title","description"]});a.fillFormData(d,{object_name:"collaboration"});b.find(".collaborators li").each(function(){var e=$(this).getTemplateData({textValues:["id"]}).id;e&&c.push(e)});a.find(":checkbox").each(function(){$(this).attr("checked",false)});for(var f in c)a.find(".collaborator_"+c[f]+" :checkbox").attr("checked",true);b.hide().after(a.show())});$("#edit_collaboration_form .cancel_button").click(function(){var a=
$(this).parents("form");a.hide().prev(".collaboration").show();a.remove()});$(document).fragmentChange(function(a,b){b=="#add_collaboration"&&$(".add_collaboration_link").click()});$(".collaboration .show_participants_link.verbose_footer_link").click(function(a){a.preventDefault();$(this).parents(".collaboration").find(".collaborators").slideToggle()});$("#collaboration_collaboration_type").change(function(){var a=$(this).val(),b=a;if(INST.collaboration_types)for(var c in INST.collaboration_types){var d=
INST.collaboration_types[c];if(d.name==a)b=d.type}$("#add_collaboration_form .collaboration_type").hide();a=$("#add_collaboration_form #"+b+"_description");a.show();$(".collaborate_data").showIf(!a.hasClass("unauthorized"));$(".collaboration_authorization").hide();$("#collaborate_authorize_"+b).showIf(a.hasClass("unauthorized"))}).change();$(".collaborate_data").find(".select_all_link,.deselect_all_link").click(function(a){a.preventDefault();var b=$(this).hasClass("select_all_link");$("#collaborator_list :checkbox").each(function(){$(this).attr("checked",
b)})})});
