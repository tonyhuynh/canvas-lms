(function(a){a.fn.extend({elastic:function(d){var e=a.extend({},d),k=["paddingTop","paddingRight","paddingBottom","paddingLeft","borderLeftWidth","borderLeftStyle","borderRightWidth","borderRightStyle","fontSize","lineHeight","fontFamily","width","fontWeight"];return this.each(function(){function l(t,H){var L=Math.floor(parseInt(t,10));m.height()!=L&&m.css({height:L+"px",overflow:H})}function p(){var t=m.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),
H=r.html();if(t+"&nbsp;"!=H){r[0].innerHTML=t+"&nbsp;";t=r.height();if(Math.abs(t+z-m.height())>3){t+=z;if(t>=o)l(o,"auto");else t<=q?l(q,"hidden"):l(t,"hidden");$.isFunction(e.callback)&&e.callback()}}}if(this.type!="textarea")return false;var m=a(this),r=a("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),z=parseInt(m.css("line-height"),10)||parseInt(m.css("font-size"),"10"),q=parseInt(m.css("height"),10)||z*3,o=parseInt(m.css("max-height"),10)||Number.MAX_VALUE,D=0;
if(o<0)o=Number.MAX_VALUE;r.appendTo(m.parent());for(D=k.length;D--;)r.css(k[D].toString(),m.css(k[D].toString()));m.css({overflow:"hidden"});m.keyup(p);m.live("input paste",function(){setTimeout(p,250)});p()})}})})(jQuery);
(function(a){a.widget("ui.selectmenu",{_init:function(){var d=this,e=this.options,k=Math.round(Math.random()*1E3);this.ids=[this.element.attr("id")+"_button_"+k,this.element.attr("id")+"_menu_"+k];this._safemouseup=true;this.newelement=a('<a class="'+this.widgetBaseClass+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" aria-haspopup="true" aria-owns="'+this.ids[1]+'"></a>').insertAfter(this.element);(k=this.element.attr("tabindex"))&&this.newelement.attr("tabindex",
k);this.newelement.data("selectelement",this.element);this.selectmenuIcon=a('<span class="'+this.widgetBaseClass+'-icon ui-icon"></span>').prependTo(this.newelement).addClass(e.style=="popup"?"ui-icon-triangle-2-n-s":"ui-icon-triangle-1-s");a("label[for="+this.element.attr("id")+"]").attr("for",this.ids[0]).bind("click",function(){d.newelement.focus();return false});this.newelement.bind("mousedown",function(q){d._toggle(q);if(e.style=="popup"){d._safemouseup=false;setTimeout(function(){d._safemouseup=
true},300)}return false}).bind("click",function(){return false}).keydown(function(q){var o=true;switch(q.keyCode){case a.ui.keyCode.ENTER:o=true;break;case a.ui.keyCode.SPACE:o=false;d._toggle(q);break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:o=false;d._moveSelection(-1);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.RIGHT:o=false;d._moveSelection(1);break;case a.ui.keyCode.TAB:o=true;break;default:o=false;d._typeAhead(q.keyCode,"mouseup")}return o}).bind("mouseover focus",function(){a(this).addClass(d.widgetBaseClass+
"-focus ui-state-hover ui-state-active")}).bind("focus",function(){a(this).addClass("ui-state-active")}).bind("blur",function(){a(this).removeClass("ui-state-active")}).bind("mouseout blur",function(){a(this).removeClass(d.widgetBaseClass+"-focus ui-state-hover")});a(document).mousedown(function(q){d.close(q)});this.element.click(function(){this._refreshValue()}).focus(function(){this.newelement.focus()});this.list=a('<ul class="'+d.widgetBaseClass+"-menu ui-widget ui-widget-content"+(e.style=="dropdown"?
" ui-corner-bottom":" ui-corner-all")+'" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"></ul>').appendTo("body");var l=[];this.element.find("option").each(function(){l.push({value:a(this).attr("value"),text:d._formatText(jQuery(this).text()),selected:a(this).attr("selected"),classes:a(this).attr("class"),parentOptGroup:a(this).parent("optgroup").attr("label")})});var p=d.options.style=="popup"?" ui-state-active":"",m;for(m in l){k=a('<li role="presentation"><a href="#" tabindex="-1" role="option" aria-selected="false">'+
l[m].text+"</a></li>").data("index",m).addClass(l[m].classes).data("optionClasses",l[m].classes||"").mouseup(function(q){if(d._safemouseup){var o=a(this).data("index")!=d._selectedIndex();d.value(a(this).data("index"));d.select(q);o&&d.change(q);d.close(q,true)}return false}).click(function(){return false}).bind("mouseover focus",function(){d._selectedOptionLi().addClass(p);d._focusedOptionLi().removeClass(d.widgetBaseClass+"-item-focus ui-state-hover");a(this).removeClass("ui-state-active").addClass(d.widgetBaseClass+
"-item-focus ui-state-hover")}).bind("mouseout blur",function(){this==d._selectedOptionLi()&&a(this).addClass(p);a(this).removeClass(d.widgetBaseClass+"-item-focus ui-state-hover")});if(l[m].parentOptGroup){var r=d.widgetBaseClass+"-group-"+l[m].parentOptGroup;this.list.find("li."+r).size()?this.list.find("li."+r+":last ul").append(k):a('<li role="presentation" class="'+d.widgetBaseClass+"-group "+r+'"><span class="'+d.widgetBaseClass+'-group-label">'+l[m].parentOptGroup+"</span><ul></ul></li>").appendTo(this.list).find("ul").append(k)}else k.appendTo(this.list);
this.list.bind("mousedown mouseup",function(){return false});if(e.icons)for(var z in e.icons)if(k.is(e.icons[z].find)){k.data("optionClasses",l[m].classes+" "+d.widgetBaseClass+"-hasIcon").addClass(d.widgetBaseClass+"-hasIcon");r=e.icons[z].icon||"";k.find("a:eq(0)").prepend('<span class="'+d.widgetBaseClass+"-item-icon ui-icon "+r+'"></span>')}}this.list.find("li:last").addClass("ui-corner-bottom");e.style=="popup"&&this.list.find("li:first").addClass("ui-corner-top");if(e.transferClasses){m=this.element.attr("class")||
"";this.newelement.add(this.list).addClass(m)}m=this.element.width();this.newelement.width(e.width?e.width:m);e.style=="dropdown"?this.list.width(e.menuWidth?e.menuWidth:e.width?e.width:m):this.list.width(e.menuWidth?e.menuWidth:e.width?e.width-e.handleWidth:m-e.handleWidth);e.maxHeight&&e.maxHeight<this.list.height()&&this.list.height(e.maxHeight);this._optionLis=this.list.find("li:not(."+d.widgetBaseClass+"-group)");this.list.keydown(function(q){var o=true;switch(q.keyCode){case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:o=
false;d._moveFocus(-1);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.RIGHT:o=false;d._moveFocus(1);break;case a.ui.keyCode.HOME:o=false;d._moveFocus(":first");break;case a.ui.keyCode.PAGE_UP:o=false;d._scrollPage("up");break;case a.ui.keyCode.PAGE_DOWN:o=false;d._scrollPage("down");break;case a.ui.keyCode.END:o=false;d._moveFocus(":last");break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:o=false;d.close(q,true);a(q.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.TAB:o=
true;d.close(q,true);break;case a.ui.keyCode.ESCAPE:o=false;d.close(q,true);break;default:o=false;d._typeAhead(q.keyCode,"focus")}return o});if(e.style=="dropdown"){this.newelement.addClass(d.widgetBaseClass+"-dropdown");this.list.addClass(d.widgetBaseClass+"-menu-dropdown")}else{this.newelement.addClass(d.widgetBaseClass+"-popup");this.list.addClass(d.widgetBaseClass+"-menu-popup")}this.newelement.prepend('<span class="'+d.widgetBaseClass+'-status">'+l[this._selectedIndex()].text+"</span>");this.element.hide();
this.element.attr("disabled")===true&&this.disable();this.value(this._selectedIndex())},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled");a("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id")).unbind("click");this.newelement.remove();this.list.remove();this.element.show()},_typeAhead:function(d,e){var k=this;if(!k._prevChar)k._prevChar=["",0];var l=String.fromCharCode(d);
c=l.toLowerCase();var p=false;this.list.find("li a").each(function(m){if(!p){var r=a(this).text();if(r.indexOf(l)===0||r.indexOf(c)===0)if(k._prevChar[0]==l){if(k._prevChar[1]<m){p=true;a(this).trigger(e);k._prevChar[1]=m}}else{p=true;a(this).trigger(e);k._prevChar[1]=m}}});this._prevChar[0]=l},_uiHash:function(){return{value:this.value()}},open:function(d){this._refreshPosition();this._closeOthers(d);this.newelement.addClass("ui-state-active");this.list.appendTo("body").addClass(this.widgetBaseClass+
"-open").attr("aria-hidden",false).find("li:not(."+this.widgetBaseClass+"-group):eq("+this._selectedIndex()+") a").focus();this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top");this._refreshPosition();this._trigger("open",d,this._uiHash())},close:function(d,e){if(this.newelement.is(".ui-state-active")){this.newelement.removeClass("ui-state-active");this.list.attr("aria-hidden",true).removeClass(this.widgetBaseClass+"-open");this.options.style=="dropdown"&&
this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all");e&&this.newelement.focus();this._trigger("close",d,this._uiHash())}},change:function(d){this.element.trigger("change");this._trigger("change",d,this._uiHash())},select:function(d){this._trigger("select",d,this._uiHash())},_closeOthers:function(d){a("."+this.widgetBaseClass+".ui-state-active").not(this.newelement).each(function(){a(this).data("selectelement").selectmenu("close",d)});a("."+this.widgetBaseClass+".ui-state-hover").trigger("mouseout")},
_toggle:function(d,e){this.list.is("."+this.widgetBaseClass+"-open")?this.close(d,e):this.open(d)},_formatText:function(d){return this.options.format?this.options.format(d):d},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetBaseClass+"-item-focus")},_moveSelection:function(d){return this._optionLis.eq(parseInt(this._selectedOptionLi().data("index"),
10)+d).trigger("mouseup")},_moveFocus:function(d){d=isNaN(d)?parseInt(this._optionLis.filter(d).data("index"),10):parseInt(this._focusedOptionLi().data("index"),10)+d;if(d<0)d=0;if(d>this._optionLis.size()-1)d=this._optionLis.size()-1;var e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1E3);this._focusedOptionLi().find("a:eq(0)").attr("id","").blur();this._optionLis.eq(d).find("a:eq(0)").attr("id",e).focus();this.list.attr("aria-activedescendant",e)},_scrollPage:function(d){var e=Math.floor(this.list.outerHeight()/
this.list.find("li:first").outerHeight());this._moveFocus(d=="up"?-e:e)},_setData:function(d,e){this.options[d]=e;if(d=="disabled")this.element.add(this.newelement).add(this.list)[e?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",e)},value:function(d){if(arguments.length){this.element[0].selectedIndex=d;this._refreshValue();this._refreshPosition()}return this.element[0].selectedIndex},_refreshValue:function(){var d=this.options.style==
"popup"?" ui-state-active":"",e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1E3);this.list.find("."+this.widgetBaseClass+"-item-selected").removeClass(this.widgetBaseClass+"-item-selected"+d).find("a").attr("aria-selected","false").attr("id","");this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-selected"+d).find("a").attr("aria-selected","true").attr("id",e);d=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"";var k=this._selectedOptionLi().data("optionClasses")?
this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(d).data("optionClasses",k).addClass(k).find("."+this.widgetBaseClass+"-status").html(this._selectedOptionLi().find("a:eq(0)").html());this.list.attr("aria-activedescendant",e)},_refreshPosition:function(){this.list.css("left",this.newelement.offset().left);var d=this.newelement.offset().top,e=this.list[0].scrollTop;this.list.find("li:lt("+this._selectedIndex()+")").each(function(){e-=a(this).outerHeight()});d+=this.newelement.is("."+
this.widgetBaseClass+"-popup")?e:this.newelement.height();this.list.css("top",d)}});a.extend(a.ui.selectmenu,{getter:"value",version:"@VERSION",eventPrefix:"selectmenu",defaults:{transferClasses:true,style:"popup",width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null}})})(jQuery);
(function(a){var d=0;a.getScrollbarWidth=function(){if(!d)if(a.browser.msie){var e=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body"),k=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1E3,left:-1E3}).appendTo("body");d=e.width()-k.width();e.add(k).remove()}else{e=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1E3,left:-1E3}).prependTo("body").append("<div />").find("div").css({width:"100%",
height:200});d=100-e.width();e.parent().remove()}return d}})(jQuery);
var rubricAssessment={init:function(){var a=$("#rubric_criterion_comments_dialog");$(".rubric").delegate(".rating","click",function(){$(this).parents(".criterion").find(".criterion_points").val($(this).find(".points").text()).change()}).delegate(".long_description_link","click",function(d){d.preventDefault();if(!$(this).parents(".rubric").hasClass("editing")){d=$(this).parents(".criterion").getTemplateData({textValues:["long_description","description"]});$("#rubric_long_description_dialog").fillTemplateData({data:d,
htmlValues:["long_description"]}).find(".editing").hide().end().find(".displaying").show().end().dialog("close").dialog({autoOpen:false,title:"Criterion Long Description",width:400}).dialog("open")}}).delegate(".criterion .saved_custom_rating","change",function(){if($(this).parents(".rubric").hasClass("assessing")){var d=$(this).val();d&&d.length>0&&$(this).parents(".custom_ratings_entry").find(".custom_rating_field").val(unescape(d))}}).delegate(".criterion_comments","click",function(d){d.preventDefault();
d.preventDefault();d=$(this).parents(".criterion");var e=d.getTemplateData({textValues:["custom_rating"]}).custom_rating,k=$(this).closest(".displaying").parents(".criterion").length===0;e={criterion_comments:e,criterion_description:d.find(".description:first").text()};a.data("current_rating",d);a.fillTemplateData({data:e});a.fillFormData(e);a.find(".editing").showIf(k);a.find(".displaying").showIf(!k);a.dialog("close").dialog({autoOpen:false,title:"Additional Comments",width:400}).dialog("open")}).find(".criterion_points").bind("keypress change blur",
function(d){d=$(d.target);if(d.parents(".rubric").hasClass("assessing")){var e=parseFloat(d.val(),10);if(isNaN(e))e=null;var k=d.parents(".criterion");k.find(".rating.selected").removeClass("selected");if(e||e===0){k.find(".criterion_description").addClass("completed");k.find(".rating").each(function(){parseFloat($(this).find(".points").text(),10)==e&&$(this).addClass("selected")})}else k.find(".criterion_description").removeClass("completed");var l=0;d.parents(".rubric").find(".criterion:visible:not(.ignore_criterion_for_scoring) .criterion_points").each(function(){var p=
parseFloat($(this).val(),10);if(isNaN(p))p=0;l+=p});d.parents(".rubric").find(".rubric_total").text(l)}});$(".rubric_summary").delegate(".rating_comments_dialog_link","click",function(d){d.preventDefault();d=$(this).parents(".criterion");var e={criterion_comments:d.getTemplateData({textValues:["rating_custom"]}).rating_custom,criterion_description:d.find(".criterion_description:first").text()};a.data("current_rating",d);a.fillTemplateData({data:e});a.fillFormData(e);a.find(".editing").hide();a.find(".displaying").show();
a.dialog("close").dialog({autoOpen:false,title:"Additional Comments",width:400}).dialog("open")});a.find(".save_button").click(function(){var d=a.find("textarea.criterion_comments").val(),e=a.data("current_rating");if(e){e.find(".custom_rating").text(d);e.find(".criterion_comments").toggleClass("empty",!d)}a.dialog("close")});a.find(".cancel_button").click(function(){a.dialog("close")});setInterval(rubricAssessment.sizeRatings,2500)},sizeRatings:function(){if($(".rubric .criterion:visible").length){var a=
$.windowScrollTop();$(".rubric .criterion:visible").each(function(){var d=$(this),e=d.find(".ratings:visible");if(e.length){var k=e.find(".rating .container").css("height","");d=Math.max(e.height(),d.find(".criterion_description .container").height());k.css("height",d-10+"px")}});$("html,body").scrollTop(a)}},assessmentData:function(a){a=rubricAssessment.findRubric(a);var d={};d["rubric_assessment[user_id]"]=rubricAssessment.assessment_user_id||a.find(".user_id").text();d["rubric_assessment[assessment_type]"]=
rubricAssessment.assessment_type||a.find(".assessment_type").text();a.find(".criterion:not(.blank)").each(function(){var e="rubric_assessment["+$(this).attr("id")+"]";d[e+"[points]"]=$(this).find(".criterion_points").val();if($(this).find(".rating.selected")){d[e+"[description]"]=$(this).find(".rating.selected .description").text();d[e+"[comments]"]=$(this).find(".custom_rating").text()}if($(this).find(".custom_rating_field:visible").length>0){d[e+"[comments]"]=$(this).find(".custom_rating_field:visible").val();
d[e+"[save_comment]"]=$(this).find(".save_custom_rating").attr("checked")?"1":"0"}});return d},findRubric:function(a){if(!a.hasClass("rubric")){$new_rubric=a.closest(".rubric");if($new_rubric.length===0)$new_rubric=a.find(".rubric:first");a=$new_rubric}return a},updateRubricAssociation:function(a,d){var e=d.summary_data;if(e&&e.saved_comments)for(var k in e.saved_comments){var l=e.saved_comments[k],p=a.find("#criterion_"+k).find(".saved_custom_rating_holder").hide(),m=p.find(".saved_custom_rating");
m.find(".comment").remove();m.empty().append('<option value="">[ Select ]</option>');for(var r in l)if(l[r]){m.append('<option value="'+escape(l[r])+'">'+$.truncateText(l[r],50)+"</option>");p.show()}}},populateRubric:function(a,d){a=rubricAssessment.findRubric(a);a.attr("id").substring(7);a.find(".user_id").text(rubricAssessment.assessment_user_id||d.user_id).end().find(".assessment_type").text(rubricAssessment.assessment_type||d.assessment_type);a.find(".criterion_description").removeClass("completed").removeClass("original_completed").end().find(".rating").removeClass("selected").removeClass("original_selected").end().find(".custom_rating_field").val("").end().find(".custom_rating_comments").text("").end().find(".criterion_points").val("").change().end().find(".criterion_rating_points").text("").end().find(".custom_rating").text("").end().find(".save_custom_rating").attr("checked",
false);a.find(".criterion_comments").addClass("empty");if(d){var e=0,k;for(k in d.data){var l=d.data[k],p=l.comments_enabled?l.comments:l.description,m=a.find("#criterion_"+l.criterion_id);l.id||m.find(".rating").each(function(){if(parseFloat($(this).find(".points").text(),10)==l.points)l.id=$(this).find(".rating_id").text()});m.find(".criterion_description").addClass("original_completed").end().find("#rating_"+l.id).addClass("original_selected").addClass("selected").end().find(".custom_rating_field").val(p).end().find(".custom_rating_comments").text(p).end().find(".criterion_points").val(l.points).change().end().find(".criterion_rating_points_holder").showIf(l.points||
l.points===0).end().find(".criterion_rating_points").text(l.points).end().find(".custom_rating").text(p).end().find(".criterion_comments").toggleClass("empty",!p).end().find(".save_custom_rating").attr("checked",false);if(l.points)e+=l.points}a.find(".rubric_total").text(e)}},populateRubricSummary:function(a,d){a.find(".criterion_points").text("").end().find(".rating_custom").text("");if(d){var e=0,k;for(k in d.data){var l=d.data[k];a.find("#criterion_"+l.criterion_id).find(".rating").hide().end().find(".rating.description").showIf(!a.hasClass("free_form")).text(l.description).end().find(".rating_"+
l.id).show().end().find(".criterion_points").text(l.points);if(l.comments_enabled&&l.comments){var p=$.truncateText(l.comments,50);a.find("#criterion_"+l.criterion_id).find(".rating_custom").show().text(p)}if(l.points)e+=l.points}a.show().find(".rubric_total").text(e);a.closest(".edit").show()}else a.hide()}};$(function(){rubricAssessment.init()});var jsonData,visibleRubricAssessments;
(function(a,d,e,k){function l(){jsonData.studentsWithSubmissions=jsonData.context.students;a.each(jsonData.studentsWithSubmissions,function(g,h){this.section_ids=a.map(a.grep(jsonData.context.enrollments,function(j){return j.user_id===h.id}),function(j){return j.course_section_id});this.submission=a.grep(jsonData.submissions,function(j){return j.user_id===h.id})[0];this.rubric_assessments=a.grep(visibleRubricAssessments,function(j){return j.user_id===h.id})});if(I=Number(a.store.userGet("eg_show_only_section"+
jsonData.context_id))){var b=a.grep(jsonData.studentsWithSubmissions,function(g){return a.inArray(I,g.section_ids)!=-1});if(b.length)jsonData.studentsWithSubmissions=b;else alert("Could not find any students in that section, falling back to showing all sections.")}var f;if(a.store.userGet("eg_hide_student_names")=="true")f=true;if(f)jsonData.studentsWithSubmissions.sort(function(g,h){return(g&&g.submission&&g.submission.id||Number.MAX_VALUE)-(h&&h.submission&&h.submission.id||Number.MAX_VALUE)});
else if(a.store.userGet("eg_sort_by")=="submitted_at")jsonData.studentsWithSubmissions.sort(function(g,h){return(g&&g.submission&&g.submission.submitted_at&&a.parseFromISO(g.submission.submitted_at).timestamp||Number.MAX_VALUE)-(h&&h.submission&&h.submission.submitted_at&&a.parseFromISO(h.submission.submitted_at).timestamp||Number.MAX_VALUE)});else a.store.userGet("eg_sort_by")=="submission_status"&&jsonData.studentsWithSubmissions.sort(function(g,h){var j={not_graded:1,resubmitted:2,not_submitted:3,
graded:4},n=p(g.submission),s=p(h.submission);return j[n]-j[s]})}function p(b){return b&&b.workflow_state!="unsubmitted"&&(b.submitted_at||typeof b.grade!="undefined")?typeof b.grade=="undefined"||b.grade===null||b.workflow_state=="pending_review"?"not_graded":b.grade_matches_current_submission?"graded":"resubmitted":"not_submitted"}function m(b){var f=p(b.submission),g=f.replace("_"," ");if(f==="resubmitted")g="graded, then resubmitted ("+a.parseFromISO(b.submission.submitted_at).datetime_formatted+
")";return{raw:f,formatted:g}}function r(){var b;if(a.store.userGet("eg_hide_student_names")=="true")b=true;a("#hide_student_names").attr("checked",b);var f=a.map(jsonData.studentsWithSubmissions,function(j,n){var s=j.name,v=m(j);if(b)s="Student "+(n+1);return'<option value="'+j.id+'" class="'+v.raw+'">'+s+" ---- "+v.formatted+"</option>"}).join("");w=a("<select id='students_selectmenu'>"+f+"</select>").appendTo("#combo_box_container").selectmenu({style:"dropdown",format:function(j){j=j.split(" ---- ");
return'<span class="ui-selectmenu-item-header">'+j[0]+'</span><span class="ui-selectmenu-item-footer">'+j[1]+"</span>"},icons:[{find:".graded"},{find:".not_graded"},{find:".not_submitted"},{find:".resubmitted"}]}).change(function(){i.handleStudentChanged()});if(jsonData.context.active_course_sections.length&&jsonData.context.active_course_sections.length>1){var g=w.data("selectmenu").list,h=a("#section-menu");h.find("ul").append(a.map(jsonData.context.active_course_sections,function(j){return'<li><a data-section-id="'+
j.id+'" href="#">'+j.name+"</a></li>"}).join(""));h.insertBefore(g).bind("mouseenter mouseleave",function(j){a(this).toggleClass("ui-selectmenu-item-selected ui-selectmenu-item-focus ui-state-hover",j.type=="mouseenter").find("ul").toggle(j.type=="mouseenter")}).find("ul").hide().menu().delegate("a","click mousedown",function(){a.store[a(this).data("section-id")=="all"?"userRemove":"userSet"]("eg_show_only_section"+jsonData.context_id,a(this).data("section-id"));window.location.reload()});if(I){a("#section_currently_showing").text(a.map(jsonData.context.active_course_sections,
function(j){if(j.id==I)return j.name}).join(", "));h.find("ul li a").removeClass("selected").filter("[data-section-id="+I+"]").addClass("selected")}w.selectmenu("option","open",function(){g.find("li:first").css("margin-top",g.find("li").height()+"px");h.show().css({left:g.css("left"),top:g.css("top"),width:g.width()-(g.hasScrollbar()&&a.getScrollbarWidth()),"z-index":Number(g.css("z-index"))+1})}).selectmenu("option","close",function(){h.hide()})}}function z(){X.find(".prev").click(function(b){b.preventDefault();
i.prev()});X.find(".next").click(function(b){b.preventDefault();i.next()});a("#settings_form").submit(function(){a.store.userSet("eg_sort_by",a("#eg_sort_by").val());a.store.userSet("eg_hide_student_names",a("#hide_student_names").attr("checked").toString());a(this).find(".submit_button").attr("disabled",true).text("Saving Settings...");window.location.reload();return false});a("#settings_link").click(function(){a("#settings_form").dialog("close").dialog({modal:true,resizeable:false,width:400}).dialog("open")})}
function q(){a("#add_a_comment textarea").elastic({callback:i.resizeFullHeight});a(".media_comment_link").click(function(b){b.preventDefault();a("#media_media_recording").show().find(".media_recording").mediaComment("create","audio",function(f,g){a("#media_media_recording").data("comment_id",f).data("comment_type",g);i.handleCommentFormSubmit()},function(){i.revertFromFormSubmit()},true);i.resizeFullHeight()});a("#media_recorder_container a").live("click",o)}function o(){a("#media_media_recording").hide().removeData("comment_id").removeData("comment_type");
i.resizeFullHeight()}function D(b){if(!b||b.assessor_id===k.assessor_id||k.assessment_type=="grading"&&b.assessment_type=="grading")return true;return false}function t(){return a.grep(i.currentStudent.rubric_assessments,function(b){return b.id==A.val()})[0]}function H(){a("#rubric_summary_container .button-container").appendTo("#rubric_assessments_list_and_edit_button_holder").find(".edit").text("Edit/View Rubric");a(".toggle_full_rubric, .hide_rubric_link").click(function(b){b.preventDefault();i.toggleFullRubric()});
A.change(function(){var b=t();k.populateRubricSummary(a("#rubric_summary_holder .rubric_summary"),b,D(b));i.resizeFullHeight()});M.draggable({axis:"x",cursor:"crosshair",scroll:false,containment:"#left_side",snap:"#full_width_container",appendTo:"#full_width_container",start:function(){M.draggable("option","minWidth",E.width())},helper:function(){return M.clone().addClass("clone")},drag:function(b,f){var g=f.offset,h=F.width();B.width(h-g.left);M.css("left","0");i.resizeFullHeight()},stop:function(b){b.stopImmediatePropagation()}});
a(".save_rubric_button").click(function(){var b=a(this).parents("#rubric_holder").find(".rubric"),f=k.assessmentData(b),g=a(".update_rubric_assessment_url").attr("href");i.toggleFullRubric();a(".rubric_summary").loadingImage();a.ajaxJSON(g,"POST",f,function(h){var j=false;if(h&&h.rubric_association){k.updateRubricAssociation(b,h.rubric_association);delete h.rubric_association}for(var n in i.currentStudent.rubric_assessments)if(h.id===i.currentStudent.rubric_assessments[n].id){i.currentStudent.rubric_assessments[n]=
h;j=true}j||i.currentStudent.rubric_assessments.push(h);i.setOrUpdateSubmission(h.artifact);a.each(h.related_group_submissions_and_assessments,function(s,v){i.setOrUpdateSubmission(h.artifact).rubric_assessments=a.map(v.rubric_assessments,function(G){return G.rubric_assessment})});a(".rubric_summary").loadingImage("remove");i.showGrade();i.showDiscussion();i.showRubric();i.updateStatsInHeader()})})}function L(){F.keycodes({keyCodes:"j k p n c r g",ignore:"input, textarea, embed, object"},function(b){b.preventDefault();
b.stopPropagation();if(b.keyString=="j"||b.keyString=="p")i.prev();else if(b.keyString=="k"||b.keyString=="n")i.next();else if(b.keyString=="f"||b.keyString=="c")J.focus();else if(b.keyString=="g")N.focus();else b.keyString=="r"&&i.toggleFullRubric()})}function ia(){var b=F.height(),f,g=E.offset().top;f=Math.max(ja,b)-g;g=a.grep([{element:R,data:{newHeight:0}},{element:ka,data:{newHeight:0}},{element:x,data:{newHeight:0}}],function(G){return G&&G.element.is(":visible")});B.css({maxHeight:f-50,overflow:"auto"});
a.each(g,function(){this.data.autoHeight=this.element.height("auto").height();this.element.height(0)});var h=f-la.height("auto").height()-y.outerHeight();ma.height(f);if((f=h)>0)for(;f>0;){h=true;var j=1E7,n=null;a.each(g,function(){if(this.data.newHeight<j&&this.data.newHeight<this.data.autoHeight){n=this;j=this.data.newHeight}});if(n){n.data.newHeight=j+1;f-=1;h=false}if(h)break}else for(var s,v;f<0;){h=true;s=0;v=null;a.each(g,function(){if(this.data.newHeight>30>s&&this.data.newHeight>=this.data.autoHeight){v=
this;s=this.data.newHeight}});if(v){v.data.newHeight=s-1;f+=1;h=false}if(h)break}a.each(g,function(){this.element.height(this.data.newHeight)});f>0&&x.height(b-Math.floor(x.offset().top)-y.outerHeight());!d.browser.ff&&x.height()>100&&x.scrollTop(1E6)}a.ajaxJSON(window.location.pathname+".json"+window.location.search,"GET",{},function(b){window.jsonData=b;a(i.jsonReady)});var F=a(window);a("body");var O=a("#full_width_container"),S=a("#left_side"),E=a("#right_side"),T=a("#width_resizer"),X=a("#gradebook_header"),
na=a("#assignment_url").attr("href"),ma=a(".full_height"),la=a("#rightside_inner"),x=a("#comments"),oa=a("#comment_blank").removeAttr("id").detach(),pa=a("#comment_attachment_blank").removeAttr("id").detach();a("#comment_media_blank").removeAttr("id").detach();var y=a("#add_a_comment"),U=y.find("button"),J=y.find("textarea");a("#group_comment_wrapper");var Y=a("#comment_attachment_input_blank").detach(),Z=1,qa=a("#add_attachment"),ja=500,ra=a("#submissions_container"),P=a("#iframe_holder"),sa=a("#x_of_x_students span"),
ta=a("#x_of_x_graded span:first"),ua=a("#average_score"),va=a("#this_student_does_not_have_a_submission").hide(),wa=a("#scribd_doc_holder"),A=a("#rubric_assessments_select"),ka=a("#rubric_summary_container");a("#rubric_holder");var V=a("#grade_container"),N=V.find("input, select"),aa=V.find(".score"),ba=a("#average_score_wrapper"),ca=a("#submission_details"),da=a("#single_submission"),xa=a("#single_submission_submitted_at"),ea=a("#multiple_submissions"),ya=a("#submission_late_notice"),za=a("#submission_not_newest_notice"),
Aa=a("#submission_files_container"),R=a("#submission_files_list"),fa=a("#submission_file_hidden").removeAttr("id").detach(),Ba=a("#submitted_files_plurality"),K=a("#submission_to_view"),Ca=a("#assignment_submission_url"),B=a("#rubric_full"),M=a("#rubric_full_resizer_handle"),w=null,ga=/^(image|html|code)$/,W=null,Q={},I;a.extend(d,{refreshGrades:function(){var b=unescape(Ca.attr("href")).replace("{{submission_id}}",i.currentStudent.submission.user_id)+".json";a.getJSON(b,function(f){i.currentStudent.submission=
f.submission;i.showGrade()})},refreshQuizSubmissionSnapshot:function(b){Q[b.user_id+"_"+b.version_number]=b;if(b.last_question_touched)d.lastQuestionTouched=b.last_question_touched},clearQuizSubmissionSnapshot:function(b){Q[b.user_id+"_"+b.version_number]=null},getQuizSubmissionSnapshot:function(b,f){return Q[b+"_"+f]}});window.onbeforeunload=function(){window.opener&&window.opener.updateGrades&&a.isFunction(window.opener.updateGrades)&&window.opener.updateGrades();var b=a.map(Q,function(f){return f&&
a.map(jsonData.context.students,function(g){return f==g&&g.name})[0]});if(b.length)return"The following students have unsaved changes to their quiz submissions: \n\n "+b.join("\n ")+"\nContinue anyway?"};var i={options:{},publicVariable:[],scribdDoc:null,currentStudent:null,domReady:function(){function b(){O.addClass("full_width");S.css("width","");E.css("width","")}F.resize(i.resizeFullHeight).resize();T.draggable({axis:"x",cursor:"crosshair",scroll:false,containment:"#full_width_container",snap:"#full_width_container",
appendTo:"#full_width_container",helper:function(){return T.clone().addClass("clone")},snapTolerance:200,drag:function(f,g){var h=g.offset,j=F.width();S.width(h.left/j*100+"%");E.width(100-h.left/j*100+"%");T.css("left","0");j-h.left<a(this).draggable("option","snapTolerance")?b():O.removeClass("full_width");if(h.left<a(this).draggable("option","snapTolerance")){S.width("0%");E.width("100%")}i.resizeFullHeight()},stop:function(f){f.stopImmediatePropagation()}}).click(function(f){f.preventDefault();
if(O.hasClass("full_width"))O.removeClass("full_width");else{b();a(this).addClass("highlight",100,function(){a(this).removeClass("highlight",4E3)})}});N.change(i.handleGradeSubmit);K.change(function(){i.currentStudent.submission.currentSelectedIndex=parseInt(a(this).val(),10);i.handleSubmissionSelectionChange()});H();q();i.initComments();z();L();F.bind("hashchange",i.handleFragementChange);a("#eg_sort_by").val(a.store.userGet("eg_sort_by"));a("#submit_same_score").click(function(f){i.handleGradeSubmit();
f.preventDefault()})},jsonReady:function(){a("#speed_grader_loading").hide();a("#gradebook_header, #full_width_container").show();l();r();i.handleFragementChange()},skipRelativeToCurrentIndex:function(b){b=(this.currentIndex()+b+jsonData.studentsWithSubmissions.length)%jsonData.studentsWithSubmissions.length;this.goToStudent(jsonData.studentsWithSubmissions[b].id)},next:function(){this.skipRelativeToCurrentIndex(1)},prev:function(){this.skipRelativeToCurrentIndex(-1)},resizeFullHeight:function(){W&&
clearTimeout(W);W=setTimeout(ia,0)},loadScribdDoc:function(b){var f=this.scribdDoc=e.Document.getDoc(b.doc_id,b.access_key);a.each({jsapi_version:1,disable_related_docs:true,auto_size:false,height:"100%"},function(g,h){f.addParam(g,h)});f.addEventListener("iPaperReady",function(){i.resizeFullHeight()});f.write("scribd_doc_holder");wa.show()},toggleFullRubric:function(b){if(!jsonData.rubric_association)return false;if(B.filter(":visible").length||b==="close"){a("#grading").height("auto").children().show();
B.fadeOut()}else{B.fadeIn();k.populateRubric(B.find(".rubric"),t());a("#grading").height(B.height()).children().hide()}this.resizeFullHeight()},handleFragementChange:function(){var b;try{b=JSON.parse(decodeURIComponent(document.location.hash.substr(1)))}catch(f){b={}}if(typeof b.student_id!="number"||!a.grep(jsonData.studentsWithSubmissions,function(g){return b.student_id==g.id}).length)b.student_id=jsonData.studentsWithSubmissions[0].id;i.goToStudent(b.student_id)},goToStudent:function(b){var f=
a.grep(jsonData.studentsWithSubmissions,function(h){return h.id===b})[0],g=w.find("option").index(w.find('option[value="'+f.id+'"]'));if(!(g>=0))throw"student not found";w.selectmenu("value",g);if(!this.currentStudent||this.currentStudent.id!=f.id)w.change()},currentIndex:function(){return a.inArray(this.currentStudent,jsonData.studentsWithSubmissions)},handleStudentChanged:function(){var b=parseInt(w.val(),10);this.currentStudent=a.grep(jsonData.studentsWithSubmissions,function(f){return f.id===
b})[0];document.location.hash="#"+encodeURIComponent(JSON.stringify({student_id:this.currentStudent.id}));this.showGrade();this.toggleFullRubric("close");this.showDiscussion();this.showRubric();this.updateStatsInHeader();this.showSubmissionDetails()},handleSubmissionSelectionChange:function(){var b=this.currentStudent.submission.submission_history[K.filter(":visible").length?Number(K.filter(":visible").val()):this.currentStudent.submission.currentSelectedIndex||0].submission,f=jsonData.due_at&&a.parseFromISO(jsonData.due_at),
g=b.submitted_at&&a.parseFromISO(b.submitted_at);b.graded_at&&a.parseFromISO(b.graded_at);var h=[],j=[];xa.html(g&&g.datetime_formatted);var n=b.turnitin_data&&b.turnitin_data["submission_"+b.id],s="#";if(n)s=a.replaceTags(a.replaceTags(a("#assignment_submission_turnitin_url").attr("href"),"user_id",b.user_id),"asset_string","submission_"+b.id);V.find(".turnitin_similarity_score").css("display",n&&n.similarity_score!=null?"":"none").attr("href",s).attr("class","turnitin_similarity_score "+(n&&n.state||
"no")+"_score").find(".similarity_score").text(n&&n.similarity_score||"--");R.html("");a.each(b.versioned_attachments,function(v,G){var u=G.attachment;u.scribd_doc&&u.scribd_doc.created&&h.push(u);ga.test(u.mime_class)&&j.push(u);var C=b.turnitin_data&&b.turnitin_data["attachment_"+u.id],ha="#";if(C)ha=a.replaceTags(a.replaceTags(a("#assignment_submission_turnitin_url").attr("href"),"user_id",b.user_id),"asset_string","attachment_"+u.id);fa.clone(true).fillTemplateData({data:{submissionId:b.user_id,
attachmentId:u.id,display_name:u.display_name,similarity_score:C&&C.similarity_score},hrefValues:["submissionId","attachmentId"]}).appendTo(R).find("a.display_name").addClass(u.mime_class).data("attachment",u).click(function(Da){Da.preventDefault();i.loadAttachmentInline(a(this).data("attachment"))}).end().find("a.turnitin_similarity_score").attr("href",ha).attr("class","turnitin_similarity_score "+(C&&C.state||"no")+"_score").attr("target","_blank").css("display",C&&C.similarity_score!=null?"":"none").end().show()});
Ba.html(b.versioned_attachments.length>1?"s":"");Aa.showIf(b.versioned_attachments.length);this.loadAttachmentInline(h[0]||j[0]);za.showIf(K.filter(":visible").find(":selected").nextAll().length);this.resizeFullHeight();ya.showIf(f&&g&&g.minute_timestamp>f.minute_timestamp)},refreshSubmissionsToView:function(){var b=jsonData.due_at&&a.parseFromISO(jsonData.due_at);if(this.currentStudent.submission.submission_history&&this.currentStudent.submission.submission_history.length>1){var f="",g=this.currentStudent.submission.submission_history[this.currentStudent.submission.submission_history.length-
1].submission;a.each(this.currentStudent.submission.submission_history,function(h,j){j=j.submission;var n=j.submitted_at&&a.parseFromISO(j.submitted_at),s=b&&n&&n.timestamp>b.timestamp;f+="<option "+(s?"class='late'":"")+" value='"+h+"' "+(j==g?"selected='selected'":"")+">"+(n&&n.datetime_formatted||"no submission time")+(s?" LATE":"")+(j.grade&&j.grade_matches_current_submission?" (grade: "+j.grade+")":"")+"</option>"});K.html(f);ea.show();da.hide()}else{ea.hide();da.show()}},showSubmissionDetails:function(){if(this.currentStudent.submission&&
this.currentStudent.submission.submitted_at){this.refreshSubmissionsToView();ca.show();this.handleSubmissionSelectionChange()}else{this.loadAttachmentInline();ca.hide()}this.resizeFullHeight()},updateStatsInHeader:function(){sa.html(a.ordinalize(i.currentIndex()+1));var b=a.grep(jsonData.studentsWithSubmissions,function(h){return h.submission&&h.submission.workflow_state==="graded"});b=a.map(b,function(h){return h.submission.score});if(b.length){ba.show();var f=function(h){for(var j=0,n=0,s=h.length;n<
s;n++)j+=h[n];return j/h.length},g=jsonData.points_possible?[" / ",jsonData.points_possible," (",Math.round(100*(f(b)/jsonData.points_possible)),"%)"].join(""):"";ua.html(""+(function(h,j){j=Math.abs(parseInt(j,10))||0;var n=Math.pow(10,j);return Math.round(h*n)/n}(f(b),2)+g))}else ba.hide();ta.html(b.length)},loadAttachmentInline:function(b){ra.children().hide();if(!this.currentStudent.submission||!this.currentStudent.submission.submission_type)va.show();else{P.empty();P.find("iframe").remove();
if(b&&b.scribd_doc&&b.scribd_doc.created&&b.worflow_state!="errored")this.loadScribdDoc(b.scribd_doc.attributes);else if(b&&ga.test(b.mime_class)){b=unescape(fa.find(".display_name").attr("href")).replace("{{submissionId}}",b.user_id).replace("{{attachmentId}}",b.id);P.html('<iframe src="'+b+'" frameborder="0"></iframe>').show()}else P.html('<iframe src="/courses/'+jsonData.context_id+"/assignments/"+this.currentStudent.submission.assignment_id+"/submissions/"+this.currentStudent.submission.user_id+
"?preview=true"+(this.currentStudent.submission&&!isNaN(this.currentStudent.submission.currentSelectedIndex)?"&version="+this.currentStudent.submission.currentSelectedIndex:"")+'" frameborder="0"></iframe>').show()}},showRubric:function(){if(jsonData.rubric_association){k.assessment_user_id=this.currentStudent.id;var b=a.grep(i.currentStudent.rubric_assessments,function(h){return h.assessor_id===k.assessor_id}),f=a.grep(i.currentStudent.rubric_assessments,function(h){return h.assessment_type=="grading"});
A.find("option").remove().end();a.each(this.currentStudent.rubric_assessments,function(){A.append('<option value="'+this.id+'">'+this.assessor_name+"</option>")});if(!b.length||k.assessment_type=="grading"&&!f.length)A.append('<option value="new">[New Assessment]</option>');var g=null;if(f.length)g=f[0].id;if(b.length)g=b[0].id;g&&A.val(g);a("#rubric_assessments_list").showIf(A.find("option").length>1);A.change()}},showDiscussion:function(){x.html("");this.currentStudent.submission&&this.currentStudent.submission.submission_comments&&
a.each(this.currentStudent.submission.submission_comments,function(b,f){if(f.submission_comment)f=f.submission_comment;f.posted_at=a.parseFromISO(f.created_at).datetime_formatted;var g=oa.clone(true).fillTemplateData({data:f});g.find("span.comment").html(f.comment.replace(/\n/g,"<br />"));var h=k.assessment_type==="grading"||k.assessor_id===f.author_id;g.find(".delete_comment_link").click(function(){a(this).parents(".comment").confirmDelete({url:"/submission_comments/"+f.id,message:"Are you sure you want to delete this comment?",
success:function(){a(this).slideUp(function(){a(this).remove()})}})}).showIf(h);f.media_comment_type&&f.media_comment_id&&g.find(".play_comment_link").show();a.each(f.cached_attachments||f.attachments,function(){var j=this.attachment||this;j.comment_id=f.id;j.submitter_id=i.currentStudent.id;g.find(".comment_attachments").append(pa.clone(true).fillTemplateData({data:j,hrefValues:["comment_id","id","submitter_id"]}).show().find("a").addClass(j.mime_class))});x.append(g.show());x.find(".play_comment_link").mediaCommentThumbnail("normal")});
x.scrollTop(9999999)},revertFromFormSubmit:function(){i.showDiscussion();i.resizeFullHeight();J.val("");setTimeout(function(){J.trigger("keyup")},0);y.find(":input").attr("disabled",false);U.text("Submit Comment")},handleCommentFormSubmit:function(){function b(h){a.each(h,function(){i.setOrUpdateSubmission(this.submission)});i.revertFromFormSubmit()}if(!a.trim(J.val()).length&&!a("#media_media_recording").data("comment_id")&&!y.find("input[type='file']:visible").length)return false;var f=na+"/submissions/"+
i.currentStudent.id,g={"submission[assignment_id]":jsonData.id,"submission[user_id]":i.currentStudent.id,"submission[group_comment]":a("#submission_group_comment").attr("checked")?"1":"0","submission[comment]":J.val()};a("#media_media_recording").data("comment_id")&&a.extend(g,{"submission[media_comment_type]":a("#media_media_recording").data("comment_type"),"submission[media_comment_id]":a("#media_media_recording").data("comment_id")});y.find("input[type='file']:visible").length?a.ajaxJSONFiles(f+
".text","PUT",g,y.find("input[type='file']:visible"),b):a.ajaxJSON(f,"PUT",g,b);a("#comment_attachments").empty();y.find(":input").attr("disabled",true);U.text("Submitting...");o()},setOrUpdateSubmission:function(b){var f=a.grep(jsonData.studentsWithSubmissions,function(g){return g.id===b.user_id})[0];f.submission=f.submission||{};a.extend(true,f.submission,b);return f},handleGradeSubmit:function(){var b=a(".update_submission_grade_url").attr("href"),f=a(".update_submission_grade_url").attr("title"),
g={"submission[assignment_id]":jsonData.id,"submission[user_id]":i.currentStudent.id,"submission[grade]":N.val()};a.ajaxJSON(b,f,g,function(h){a.each(h,function(){i.setOrUpdateSubmission(this.submission)});i.refreshSubmissionsToView();i.showGrade()})},showGrade:function(){N.val(typeof i.currentStudent.submission!="undefined"&&i.currentStudent.submission.grade!==null?i.currentStudent.submission.grade:"").attr("disabled",typeof i.currentStudent.submission!="undefined"&&i.currentStudent.submission.submission_type===
"online_quiz");a("#submit_same_score").hide();if(typeof i.currentStudent.submission!="undefined"&&i.currentStudent.submission.score!==null){aa.text(i.currentStudent.submission.score);i.currentStudent.submission.grade_matches_current_submission||a("#submit_same_score").show()}else aa.text("");i.updateStatsInHeader();a.each(jsonData.studentsWithSubmissions,function(b){var f=w.data("selectmenu").list.find("li:eq("+b+")");b=m(this);if(this==i.currentStudent)f=f.add(w.data("selectmenu").newelement);f.removeClass("not_graded not_submitted graded resubmitted").addClass(b.raw).find(".ui-selectmenu-item-footer").text(b.formatted);
a.each("not_graded not_submitted graded resubmitted".split(" "),function(){f.data("optionClasses",f.data("optionClasses").replace(this,""))})})},initComments:function(){U.click(function(b){b.preventDefault();i.handleCommentFormSubmit()});qa.click(function(b){b.preventDefault();b=Y.clone(true);b.find("input").attr("name","attachments["+Z+"][uploaded_data]");Z++;a("#comment_attachments").append(b.show());i.resizeFullHeight()});Y.find("a").click(function(b){b.preventDefault();a(this).parents(".comment_attachment_input").remove();
i.resizeFullHeight()});E.delegate(".play_comment_link","click",function(){var b=a(this).parents(".comment").getTemplateData({textValues:["media_comment_id"]}).media_comment_id;b&&a(this).parents(".comment").find(".media_comment_content").show().mediaComment("show",b,"audio");return false})}};a(i.domReady)})(jQuery,INST,scribd,rubricAssessment);
