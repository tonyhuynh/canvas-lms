(function(){function o(b){var a=b.data("object_id");if(!a){a=b.find(".table_entry,.student_header,.assignment_header").attr("id");a=a.replace(/^outer_/,"")}b.data("object_id",a);b=object_data[a];for(var g=a.split(/[_-]/),e=[];g.length>0&&isNaN(parseInt(g[0],10));)e.push(g.shift());g=e.join("_");if(b){a=b[g]||b.audit_student||b.user;if(!a)for(var r in b)a=b[r];a[g+"_id"]=a.id;b=a}else{e=a.split("_");b={};if(e[0]=="submission"){b.user_id=e[1];b.assignment_id=e[2]}object_data[a]={};object_data[a][e[0]]=
b}if(g=="submission"){r=object_data["assignment_"+b.assignment_id];r=r.assignment;b.assignment_group_id=r.assignment_group_id;b.points_possible=r.points_possible}return b}function L(b,a){var g=N.getFormData(),e=$("#submission_"+b.student_id+"_"+b.assignment_id);e.parent();e.loadingImage({image_size:"small"});t({user_id:b.student_id,assignment_id:b.assignment_id,grade:b.grade});if(b.id&&b.id!=="")g["submission[id]"]=b.id;if(b.comment)g["submission[comment]"]=b.comment;g["submission[group_comment]"]=
b.group_comment?"1":"0";g["submission[assignment_id]"]=b.assignment_id;g["submission[user_id]"]=b.student_id;g["submission[grade]"]=b.grade;var r=function(q){for(var m in q){var k=q[m].submission;t(k);T(k.user_id)}q.length>1&&alert(q.length+" Students Updated");e.loadingImage("remove")},s=function(){e.loadingImage("remove")};a&&z.find(".comment_attachments input[type='file']").length?$.ajaxJSONFiles(N.attr("action")+".text","POST",g,z.find(".comment_attachments input[type='file']"),r,s):$.ajaxJSON(N.attr("action"),
"POST",g,r,s)}function t(b){if(b){var a=null;if(!datagrid.initialized){var g=datagrid.cells[gradebook.studentIndexes[b.user_id]+","+gradebook.assignmentIndexes[b.assignment_id]];a=g&&g.find("#submission_"+b.student_id+"_"+b.assignment_id);if(!a||!a.length){gradebook.queuedSubmissions=gradebook.queuedSubmissions||[];gradebook.queuedSubmissions.push(b);return}}object_data["submission_"+b.user_id+"_"+b.assignment_id]={submission:b};g=(g=object_data["assignment_"+b.assignment_id])&&g.assignment;b.student_id=
b.user_id;a=a||$("#submission_"+b.student_id+"_"+b.assignment_id);var e=b&&$.parseFromISO(b.submitted_at).minute_timestamp,r=g&&$.parseFromISO(g.due_at).minute_timestamp;a.parent().toggleClass("late",!!(g&&b&&g.due_at&&b.submission_type&&b.submitted_at&&e>r));if(b.grade!==""&&b.grade==0)b.grade="0";e=a.find(".score");var s=a.find(".pending_review");r=a.find(".turnitin");var q=a.find(".grade");e.showIf(b.score);a.fillTemplateData({data:b});if(b.submission_type!="online_quiz"||b.workflow_state!="pending_review")s.remove();
else if(!s.length){q.after($("#gradebook_urls .pending_review").clone());s.addClass("showable").showIf(!a.find(".grading_value:visible").length)}a=null;if(b.turnitin_data){if(b.attachments&&b.submission_type=="online_upload")for(var m in b.attachments){s=b.attachments[m].attachment;if(s=b.turnitin_data&&b.turnitin_data["attachment_"+s.id]){a=a||{};a.items=s.items||[];a.items.push(s)}}else if(b.submission_type=="online_text_entry")if(s=b.turnitin_data&&b.turnitin_data["submission_"+b.id]){a=a||{};
a.items=s.items||[];a.items.push(s)}if(a){s={failure:4,problem:3,warning:2,acceptable:1};var k=0;for(m=0;m<a.items.length;m++)k+=s[a.items[m].state];a.state={"0":"none","1":"acceptable","2":"warning","3":"problem","4":"failure"}[Math.floor(k/a.items.length)]||"no"}}if(a){if(!r.length){m=$("#gradebook_urls .turnitin").clone();m.attr("src",m.attr("src").replace("turnitin_no_score","turnitin_"+a.state+"_score"));q.after(m);r.addClass("showable").show()}}else r.remove();e.showIf(g&&g.grading_type=="letter_grade");
$("#outer_assignment_"+b.assignment_id).find(".grading_type").text()=="pass_fail"&&b.grade&&b.grade!=" - "&&q.empty().append($("#submission_entry_"+b.grade+"_image").clone());if(b.grade==null||b.grade==="")q.empty().append(v(b))}}function v(b){b=$("#submission_"+b.submission_type+"_image").clone().attr("id","");if(b.length===0)b=" - ";return b}function A(b,a){var g=object_data["assignment_"+a.assignment_id].assignment,e=$("#outer_student_"+a.user_id+" .display_name").text(),r=$("#outer_assignment_"+
a.assignment_id+" .display_name").text(),s="Submission Information",q=b.find(".grade"),m=b.find(".score"),k=$.trim(q.text()),c=$("#student_grading_"+a.assignment_id).clone(),h=a.comment||"";h=a.points_possible;var i=$(document.createElement("div")),j=$(document.createElement("div")),f=$("#gradebook_urls .view_online_submission_url").attr("href");if(e&&r)s=r+": "+e;if(q.find("img").length>0)k=q.find("img").attr("alt");if(m.length>0)k=m.text();if(k=="_"||k=="-")k="";if(c[0].tagName!="SELECT"||k!="")c.val(k);
f=$.replaceTags(f,"assignment_id",a.assignment_id);f=$.replaceTags(f,"user_id",a.user_id);i.append($("#submission_view_image").clone(true).removeAttr("id"));i.append($(" <a href='"+f+"'>Submission Details</a>"));j.css({textAlign:"center",fontWeight:"bold",fontSize:"1.2em",marginTop:5});if(a.submission_type&&a.submission_type!="online_quiz")if(a.submission_type=="online_url"){j.append($("#submission_"+a.submission_type+"_image").clone().removeAttr("id"));f=a.url;j.append(" <a href='"+f+"' target='_new'>Go To Submission URL</a>")}else if(a.submission_type==
"online_upload"){f=$("#gradebook_urls .view_online_upload_url").attr("href");f=$.replaceTags(f,"assignment_id",a.assignment_id);f=$.replaceTags(f,"user_id",a.user_id);if(a.attachments)for(var l in a.attachments){e=a.attachments[l].attachment;r=$.replaceTags(f,"attachment_id",e.id);if(q=a.turnitin_data&&a.turnitin_data["attachment_"+e.id]){m=$.replaceTags($.replaceTags($.replaceTags($(".turnitin_report_url").attr("href"),"user_id",a.user_id),"asset_string","attachment_"+e.id),"assignment_id",a.assignment_id);
k=$("<a/>");k.attr("href",m).addClass("turnitin_similarity_score").addClass((q&&q.state||"no")+"_score");k.attr("title","Turnitin similarity score -- more information");k.attr("target","_blank");k.text((q.similarity_score||"--")+"%");j.append(k)}j.append($("#submission_"+a.submission_type+"_image").clone().removeAttr("id"));j.append(" <a href='"+r+"'>Download "+e.display_name+"</a><br/>")}}else{if(a.submission_type=="online_text_entry"){if(q=a.turnitin_data&&a.turnitin_data["submission_"+a.id]){m=
$.replaceTags($.replaceTags($.replaceTags($(".turnitin_report_url").attr("href"),"user_id",a.user_id),"asset_string","submission_"+a.id),"assignment_id",a.assignment_id);k=$("<a/>");k.attr("href",m).addClass("turnitin_similarity_score").addClass((q&&q.state||"no")+"_score");k.attr("title","Turnitin similarity score -- more information");k.attr("target","_blank");k.text(q.similarity_score+"%");j.append(k)}j.append($("#submission_"+a.submission_type+"_image").clone().removeAttr("id"));f=$("#gradebook_urls .view_online_text_entry_url").attr("href");
f=$.replaceTags(f,"assignment_id",a.assignment_id);f=$.replaceTags(f,"user_id",a.user_id);j.append(" <a href='"+f+"' target='_new'>View Submission</a>")}}else if(a.quiz_submission){f=$("#gradebook_urls .view_quiz_url").attr("href");f=$.replaceTags(f,"quiz_id",a.quiz_submission.quiz_id);f=$.replaceTags(f,"user_id",a.user_id);if(a.workflow_state=="pending_review"){j.append($("#submission_pending_review_image").clone().removeAttr("id"));j.append(" <a href='"+f+"' target='_new'>Finish Scoring this Quiz</a>")}else{j.append($("#submission_quiz_image").clone().removeAttr("id"));
j.append(" <a href='"+f+"' target='_new'>View this Quiz</a>")}}else if(a.submission_type=="online_text_entry"){f=$("#gradebook_urls .view_online_text_entry_url").attr("href");f=$.replaceTags(f,"assignment_id",a.assignment_id);f=$.replaceTags(f,"user_id",a.user_id);if(q=a.turnitin_data&&a.turnitin_data["submission_"+a.id]){m=$.replaceTags($.replaceTags($.replaceTags($(".turnitin_report_url").attr("href"),"user_id",a.user_id),"asset_string","submission_"+a.id),"assignment_id",a.assignment_id);k=$("<a/>");
k.attr("href",m).addClass("turnitin_similarity_score").addClass((q&&q.state||"no")+"_score");k.attr("title","Turnitin similarity score -- more information");k.attr("target","_blank");k.text(q.similarity_score+"%");j.append(k)}j.append($("#submission_"+a.submission_type+"_image").clone().removeAttr("id"));j.append(" <a href='"+f+"' target='_new'>View Submission</a>")}z.find(".no_comments").hide().end().find(".add_comment_link").hide().end().find(".points_possible").text(h||"").end().find(".out_of").showIf(h||
h==="0").end().find(".grade_entry").empty().append(c.show()).end().find("textarea.comment_text").show().val("").end().find(".submission_details").empty().append(i).append(j).show().end().find(".submission_comments").empty().end().find(".comment_attachments").empty().end().find(".group_comment").showIf(g&&g.group_category).find(":checkbox").attr("checked",true).end().end();a.student_id=a.user_id;a.id=a.id||"";g=g.due_at&&a.submitted_at&&Date.parse(g.due_at)<Date.parse(a.submitted_at);z.find(".submitted_at_box").showIf(a.submitted_at).toggleClass("late_submission",
!!g);a.submitted_at_string=$.parseFromISO(a.submitted_at).datetime_formatted;z.fillTemplateData({data:a,except:["created_at","submission_comments","submission_comment","comment","attachments","attachment"]});for(l in a.submission_comments){h=a.submission_comments[l].submission_comment;g=$("#submission_comment_blank").clone(true).removeAttr("id");h.posted_at=$.parseFromISO(h.created_at).datetime_formatted;g.fillTemplateData({data:h,except:["attachments"]});if(h.attachments)for(var d in h.attachments){e=
h.attachments[d].attachment;c=$("#submission_comment_attachment_blank").clone().removeAttr("id").show();e.assignment_id=a.assignment_id;e.user_id=a.user_id;e.comment_id=h.id;c.fillTemplateData({data:e,hrefValues:["assignment_id","user_id","id","comment_id"]});g.find(".attachments").append(c)}z.find(".submission_comments").append(g.show())}z.show().dialog("close").dialog({width:500,height:"auto",title:s,open:function(){z.find(".grading_value").focus().select();$("#gradebook").data("disable_highlight",
true)},close:function(){$("#gradebook").data("disable_highlight",false)},autoOpen:false}).dialog("open").dialog("option","title",s)}function F(b){var a=o(b);if(a&&a.submission_comments)A(b,a);else{$("#loading_submission_details_dialog").dialog("close").dialog({autoOpen:false,title:"Loading..."}).dialog("open");var g=$("#loading_submission_details_dialog .submission_details_url").attr("href");g=$.replaceTags($.replaceTags(g,"user_id",a.user_id),"assignment_id",a.assignment_id);$.ajaxJSON(g,"GET",{},
function(e){$("#loading_submission_details_dialog").dialog("close");e.submission.submission_comments=e.submission.submission_comments||[];object_data["submission_"+a.user_id+"_"+a.assignment_id]=e;a=o(b);A(b,a)},function(){})}}function D(){gradebook.updateAllStudentGrades=function(b){gradebook.finalGradesReady=false;if(b)for(var a in object_data)if(object_data[a].submission){b=object_data[a].submission;M[b.user_id]=M[b.user_id]||[];M[b.user_id].push(b)}$(".outer_student_name").each(function(){var g=
o($(this));O.push(g.id)})};setInterval(function(){if(O.length>0){var b=O.shift();if(M[b]){for(var a in M[b])t(M[b][a]);M[b]=null}T(b)}else gradebook.finalGradesReady=true},100);gradebook.updateAllStudentGrades();$("html,body").scrollTop(0);$(".outer_assignment_name").each(function(){var b=$(this),a=o(b),g={title:a.title,id:a.assignment_id,date_sortable:a.due_at,group_id:a.assignment_group_id,special_sort:"a"};g.id=g.id||b.find(".student_header").attr("id").substring(17);if(b.hasClass("final_grade")){g.special_sort=
"z";g.group_id="z"}else if(b.hasClass("group_total")){a=$("#groups_data .group").index($("#group_"+a.assignment_group_id));g.special_sort="y_"+a}b.data("assignment_object",g)})}function G(b){var a=0,g=$("#class_weighting_policy").attr("checked");$("#groups_data").find(".group").each(function(){var e=$(this).find(".group_weight").val();e=parseFloat(e);if(isNaN(e))e=0;if(b){var r=$(this).getTemplateData({textValues:["assignment_group_id"]}).assignment_group_id,s=e+"%",q=" of grade";if(!g)q=s="";$("#outer_assignment_group-"+
r+",#assignment_group-"+r).find(".points_possible").text(s).end().find(".before_points_possible").text("").end().find(".after_points_possible").text(q)}a+=e});$("#groups_data").find(".total_weight").text(a);b&&gradebook.updateAllStudentGrades&&gradebook.updateAllStudentGrades()}function H(b,a){if(a)if(!(a&&a.length===0)){var g=a.getTemplateData({textValues:["assignment_group_id","rules"]});g=$.extend(g,a.getFormData());var e=b[g.assignment_group_id]||{};if(!e.group_weight)e.group_weight=parseFloat(g.group_weight)/
100;e.scores=e.scores||[];e.full_points=e.full_points||[];e.count=e.count||0;e.submissions=e.submissions||[];e.scored_submissions=e.scored_submissions||[];e.sorted_submissions=e.sorted_submissions||[];if(e.score_total!==null||e.full_total!==null){e.calculated_score=e.score_total/e.full_total;if(isNaN(e.calculated_score)||!isFinite(e.calculated_score))e.calculated_score=0}e.score_total=e.score_total||0;e.full_total=e.full_total||0;if(!e.rules){g.rules=g.rules||"";var r={drop_highest:0,drop_lowest:0,
never_drop:[]},s=g.rules.split("\n"),q;for(q in s){var m=s[q].split(":"),k=null;if(m.length>1)k=parseInt(m[1],10);if(k&&!isNaN(k)&&isFinite(k))if(m[0]=="drop_lowest")r.drop_lowest=k;else if(m[0]=="drop_highest")r.drop_highest=k;else m[0]=="never_drop"&&r.never_drop.push(k)}e.rules=r}return b[g.assignment_group_id]=e}}function T(b){var a=$(".table_entry.student_"+b);if(a.length!==0){var g={};$("#groups_data .group").each(function(){H(g,$(this))});a.each(function(){if(!$(this).find(".grade").hasClass("hard_coded")){var f=
o($(this).parent()),l=g[f.assignment_group_id];l||(l=H($("#group_"+f.assignment_group_id)));if(l)if(!(ignoreUngradedSubmissions&&(f.grade==null||f.grade===""))){var d=parseFloat(f.score);if(!d||isNaN(d)||!isFinite(d))d=0;var n=parseFloat(f.points_possible);if(!n||isNaN(n))n=0;var p=d/n;if(isNaN(p)||!isFinite(p))p=0;f.calculated_score=d;f.calculated_possible=n;f.calculated_percent=p;l.submissions.push(f);if(f.score||f.score===0)l.scored_submissions.push(f);g[f.assignment_group_id]=l}}});for(var e in g){a=
g[e];a.sorted_submissions=a.submissions.sort(function(f,l){var d=[f.calculated_percent,(object_data["assignment_"+f.assignment_id]||{}).due_at],n=[l.calculated_percent,(object_data["assignment_"+l.assignment_id]||{}).due_at];if(d>n)return 1;if(d==n)return 0;return-1});for(var r=0,s=0,q=a.scored_submissions.length,m=0;m<a.sorted_submissions.length;m++)a.sorted_submissions[m].calculated_drop=false;for(m=0;m<a.sorted_submissions.length;m++){var k=a.sorted_submissions[m];if(!k.calculated_drop&&r<a.rules.drop_lowest&&
r+s+1<q&&k.calculated_possible>0&&$.inArray(k.assignment_id,a.rules.never_drop)==-1){r++;k.calculated_drop=true}a.sorted_submissions[m]=k}for(m=a.sorted_submissions.length-1;m>=0;m--){k=a.sorted_submissions[m];if(!k.calculated_drop&&s<a.rules.drop_highest&&r+s+1<q&&k.calculated_possible>0&&$.inArray(k.assignment_id,a.rules.never_drop)==-1){s++;k.calculated_drop=true}a.sorted_submissions[m]=k}for(m=0;m<a.sorted_submissions.length;m++){k=a.sorted_submissions[m];if(k.calculated_drop)$("#submission_"+
k.user_id+"_"+k.assignment_id).parent().addClass("dropped");else{$("#submission_"+k.user_id+"_"+k.assignment_id).parent().removeClass("dropped");a.scores.push(k.calculated_score);a.full_points.push(k.calculated_possible);a.count++;a.score_total+=k.calculated_score;a.full_total+=k.calculated_possible}}g[e]=a}var c=0;var h=e=0,i=0,j=0;$.each(g,function(f,l){H(g,$("#group_"+f));var d=Math.round(l.calculated_score*1E3)/10;$("#submission_"+b+"_group-"+f).attr("data-tip","pts: "+l.score_total+" / "+l.full_total).find(".grade").text(d).end().find(".score").hide().end().find(".pct").text(" %").show();
d=l.calculated_score*l.group_weight;if(isNaN(d)||!isFinite(d))d=0;if(ignoreUngradedSubmissions&&l.count>0)i+=l.group_weight;c+=d;j+=l.score_total;h+=l.full_total});e=parseFloat($("#groups_data .total_weight").text());if(!$("#class_weighting_policy").attr("checked")||isNaN(e)||!isFinite(e)||e===0)e=Math.round(1E3*j/h)/10;else{e=parseFloat($("#groups_data .total_weight").text())/100;if(isNaN(e)||!isFinite(e)||e===0)e=1;if(ignoreUngradedSubmissions&&i<1)c=(e<1?e:1)*c/i;e=Math.round(c*1E3)/10}if(isNaN(e)||
!isFinite(e))e=0;$("#submission_"+b+"_final-grade").attr("data-tip",gradebook.pointCalculations?"pts: "+j+" / "+h:"").find(".grade").text(e).end().find(".score").hide().end().find(".pct").text(" %").show()}}function P(b){$("#datagrid_topleft").gradebookLoading();$.ajaxJSON("http://"+location.host+location.pathname+"?updated="+lastGradebookUpdate,"GET",{},function(a){b&&setTimeout(function(){P(true)},12E4);$("#datagrid_topleft").gradebookLoading("remove");var g=lastGradebookUpdate;for(idx in a){var e=
a[idx].submission;e.student_id=e.user_id;if(e.updated_at.substring(0,19)>lastGradebookUpdate){t(e);if(e.updated_at>g)g=e.updated_at.substring(0,19)}}lastGradebookUpdate=g},function(){b&&setTimeout(function(){P(true)},24E4);$("#datagrid_topleft").gradebookLoading("remove")},{})}var E=$("#loading_gradebook_progressbar"),B=$("#default_grade_form"),R=$("#assignment_details_dialog"),z=$("#submission_information"),N=$("#update_submission_form"),I=$("#curve_grade_dialog");$("#message_students_dialog");var S=
$("#information_link"),J=$("#total_tooltip"),V=$("#content").offset();window.gradebook={hoverCount:-1,fileIndex:1,assignmentIndexes:{},studentIndexes:{},showInfoLink:function(b){if(!datagrid.currentFocus){var a=b.find(".table_entry");if(b.hasClass("group_total")||b.hasClass("final_grade")){S.hide();if(a.attr("data-tip")){b=b.offset();J.show().find(".text").text(a.attr("data-tip"));a=J.outerHeight();J.css({left:b.left-V.left+2,top:b.top-V.top-a-3})}else J.hide()}else if(!a.length||a.find(".new_message,.pending_review,.turnitin").filter(":visible").length||
b.hasClass("group_total")||b.hasClass("final_grade")){S.hide();J.hide()}else{J.hide();S.appendTo(a).show()}}},hideInfoLink:function(){J.hide();S.hide();gradebook.hoverCount=-1},populate:function(){gradebook.updateAllStudentGrades&&gradebook.updateAllStudentGrades()},makeAccessible:function(){var b=$("#datagrid_data .content"),a=$("#datagrid_left .display_name");b.attr("role","grid").prepend(function(){return"<div class='hidden-readable' role='row'><div role='columnheader' tabindex='-1'>Student Name</div>"+
$("#datagrid_top .assignment_title").map(function(){return"<div role='columnheader' id='th_"+$(this).parents(".assignment_header").attr("id")+"' tabindex='-1'>"+$(this).text()+"</div>"}).get().join("")+"</div>"}).find(".row").attr("role","row").prepend(function(g){return"<div id='th_"+a.eq(g).parents(".student_header").attr("id")+"' tabindex='-1' class='ui-helper-hidden-accessible' role='rowheader'>"+a.eq(g).text()+"</div>"});b.find(".data_cell").attr({role:"gridcell",tabindex:-1,"aria-labelledby":function(){var g=
$(this).find(".table_entry").attr("id").split("_");return"th_assignment_"+g[2]+" th_student_"+g[1]}})}};$(document).ready(function(){gradebook.pointCalculations=!$("#class_weighting_policy").attr("checked");var b=function(){$("#gradebook_full_content").hide();setTimeout(function(){$("#gradebook_table").bind("entry_over",function(c,h){if(h.trueEvent){gradebook.showInfoLink(h.cell);if(h.cell.hasClass("late"))h.cell.attr("title","This submission was submitted late");else h.cell.hasClass("dropped")?h.cell.attr("title",
"This submission is dropped for grading purposes"):h.cell.attr("title","")}else c&&c.originalEvent&&c.originalEvent.type&&!c.originalEvent.type.match(/mouse/)&&h.cell.find(".grade").focus().css("outline",0)}).bind("entry_out",function(){gradebook.hideInfoLink()}).bind("entry_click",function(c,h){var i=h.cell;c.originalEvent&&$(c.originalEvent.target).closest(".display_name,.assignment_title").length==0&&c.originalEvent.preventDefault();if(!(i.hasClass("column_header")||i.hasClass("row_header")||i.find(".grade").hasClass("hard_coded"))){h.cell.data("from_click",
true);datagrid.focus(i.row,i.column);h.cell.data("from_click",false)}}).bind("entry_focus",function(c,h){var i=h.cell.find(".table_entry"),j=i.find(".grade"),f=true,l=$.trim(j.text());gradebook.hideInfoLink();if(i.find(".grade img.submission_icon").length>0&&h.cell.data("from_click")){F(h.cell);datagrid.blur()}else{if(j.hasClass("hard_coded"))f=false;if(f){if(j.find("img.graded_icon").length)l=j.find("img.graded_icon").attr("alt").toLowerCase();else if(i.find(".score").length>0&&!(l&&l.match(/.+%/)))l=
$.trim(i.find(".score").text());l=$.trim(l);if(l=="-")l="";var d=o(h.cell);if(f){f=h.cell.width();var n=h.cell.height();d=$("#student_grading_"+d.assignment_id).clone(true);var p=d.children().andSelf().filter(".grading_value");j.hide().after(d);d.css("display","block");if(p.attr("type")=="text"){f-=8;n-=8}else{f-=2;n-=2}d.width(f).height(n).css("margin",1);p.height(n);if(p[0].tagName!="SELECT"||l!=="")p.val(l);d.show();p.focus().select()}i.find(".new_message,.pending_review").hide()}}}).bind("entry_blur",
function(c,h){var i=h.cell.find(".table_entry");i.find(".new_message,.pending_review.showable,.grade").show();i.find(".grading_box").remove();h.cell.triggerHandler("mouseover");setTimeout(function(){gradebook.showInfoLink(h.cell)},50)});setTimeout(a,50)},1E3)},a=function(){$(".delete_comment_attachment_link").click(function(c){c.preventDefault();$(this).parents(".comment_attachment").slideUp(function(){$(this).remove()})});$(".attach_comment_file_link").click(function(c){c.preventDefault();c=$(this).parents(".add_comment").find(".comment_attachment:last").clone(true);
c.find("input").attr("name","attachments["+gradebook.fileIndex++ +"][uploaded_data]");$(this).parents(".add_comment").find(".comment_attachments").append(c);c.slideDown()});$(".grading_value").keycodes("esc return tab",function(c){c.preventDefault();c.stopPropagation();if(c.keyString=="return"||c.keyString=="tab"){$(this).triggerHandler("blur",true);c.keyString=="return"?datagrid.moveDown():datagrid.moveRight()}else if(c.keyString=="esc"){c=$(this).parents("[role='gridcell']");datagrid.blur();c.focus()}});
$(".grading_value").blur(function(c,h){if($(this).parents(".table_entry").parents("div.cell").length>0){var i=$(this);if(i.parents(".grading_box").length)i=i.parents(".grading_box");var j=i,f=j;i=f.parents(".table_entry");j.hasClass("grading_value")||(f=j.find(".grading_value"));var l=j=f.val(),d=$.trim(i.find(".grade").text());if(i.find(".grade img").length>0)d=i.find(".grade img").attr("alt").toLowerCase();if(d=="-")d="";if(f.hasClass("pass_fail"))if(j=="pass"||j=="fail")j=$("#submission_entry_"+
j+"_image").clone().attr("id","");f={};N.getFormData();var n=o(i.parent());f.id=n.id||"";f.assignment_id=n.assignment_id;f.student_id=n.user_id;f.grade=l;if(l!=d||l&&h)L(f);if(!j||j==""){f.submission_type=n.submission_type||"";j=v(f)}i.find(".grade").show().empty().append(j);datagrid.blur()}});B.formSubmit({beforeSubmit:function(){B.loadingImage().find(".cancel_button").attr("disabled",true)},processData:function(c){var h=0;$(".table_entry.assignment_"+c.assignment_id+":visible").each(function(){var i=
$(this);i=o(i.parent());var j="submissions[submission_"+h+"]";if(!i.score&&i.score!==0||c.overwrite_existing_grades){c[j+"[assignment_id]"]=c.assignment_id;c[j+"[user_id]"]=i.user_id;c[j+"[grade]"]=c.default_grade;h++}});if(h===0){alert("None to Update");return false}return c},success:function(c){B.loadingImage("remove");for(var h in c){var i=c[h].submission;t(i);O.push(i.user_id)}alert(c.length+" Student scores updated");B.find(".cancel_button").attr("disabled",false);B.dialog("close")}}).find(".cancel_button").click(function(){B.dialog("close")});
$("#gradebook_full_content,.datagrid").delegate(".assignment_dropdown","click",function(){var c=$(this),h=c.parents(".assignment_name").find(".grade_assignment_link").attr("href"),i=c.parents(".assignment_name"),j=$(this).parents(".cell");c={};var f=o(i);if(!i.hasClass("group_total")&&!i.hasClass("final_grade")){c['<span class="ui-icon ui-icon-info">&nbsp;</span> Assignment Details']=function(){var d=o(i),n=$(".student_assignment .assignment_"+d.assignment_id);d.url=i.find(".assignment_link").attr("href");
d.cnt=0;d.score_total=0;n.each(function(){var u=$(this);u=o(u.parent());if(u.score!==null&&u.score!==undefined&&u.score!==""){d.cnt++;d.score_total+=u.score;if(d.max==null||u.score>d.max)d.max=u.score;if(d.min==null||u.score<d.min)d.min=u.score}});d.max=d.max||0;d.min=d.min||0;d.average=Math.round(d.score_total*10/d.cnt)/10;if(isNaN(d.average)||!isFinite(d.average))d.average="N/A";var p=n=0;R.find(".distribution").showIf(d.average&&d.points_possible).find(".none_left").width(p=200*(d.min/d.points_possible)).css("left",
(n+=p)-p).end().find(".some_left").width(p=200*((d.average-d.min)/d.points_possible)).css("left",(n+=p)-p).end().find(".some_right").width(p=200*((d.max-d.average)/d.points_possible)).css("left",(n+=p)-p-2).end().find(".none_right").width(p=200*((d.points_possible-d.max)/d.points_possible)).css("left",(n+=p)-p);R.fillTemplateData({data:d}).dialog("close").dialog({autoOpen:false,title:"Details: "+d.title}).dialog("open").find(".assignment_link").attr("href",d.url)};c['<span class="ui-icon ui-icon-newwin">&nbsp;</span> SpeedGrader']=
function(){window.open(h)};c['<span class="ui-icon ui-icon-mail-closed">&nbsp;</span> Message Students Who...']=function(){var d=o(i),n=d.title,p=$("#datagrid_data .assignment_"+d.id),u={};$("#datagrid_left .student_header").each(function(){var x={};x.id=$(this).attr("id").substring(8);x.name=$(this).find(".display_name").text();u[x.id]=x});p.each(function(){var x=o($(this).parent());if(u[x.user_id]){u[x.user_id].score=x.score;u[x.user_id].submitted_at=x.submitted_at;u[x.user_id].graded_at=x.graded_at}});
p=[];for(var w in u)p.push(u[w]);window.messageStudents({options:[{text:"Haven't submitted yet"},{text:"Scored less than",cutoff:true},{text:"Scored more than",cutoff:true}],title:n,points_possible:d.points_possible,students:p,callback:function(x,K,C){C=$.grep(C,function(y){y=y.user_data;if(x=="Haven't submitted yet")return!y.submitted_at&&!y.graded_at;else if(x=="Scored less than")return y.score!=null&&y.score!=""&&K!=null&&y.score<K;else if(x=="Scored more than")return y.score!=null&&y.score!=""&&
K!=null&&y.score>K});return $.map(C,function(y){return y.user_data.id})}})};c['<span class="ui-icon ui-icon-check">&nbsp;</span> Set Default Grade']=function(){var d=o(i),n=d.title;B.find(".assignment_title").text(n).end();B.find(".assignment_id").val(d.assignment_id);B.find(".out_of").showIf(d.points_possible||d.points_possible==="0");B.find(".points_possible").text(d.points_possible);var p=$.replaceTags(B.find(".default_grade_url").attr("href"),"id",d.id);p=N.attr("action");B.attr("action",p).attr("method",
"POST");d=$box=$("#student_grading_"+d.id).clone();$box.hasClass("grading_value")||(d=$box.find(".grading_value"));d.attr("name","default_grade").show();B.find(".grading_box_holder").empty().append($box);B.dialog("close").dialog({autoOpen:false,width:350,height:"auto",open:function(){B.find(".grading_box").focus()}}).dialog("open").dialog("option","title","Default Grade for "+n)};if(f.grading_type!="pass_fail"&&f.points_possible)c['<span class="ui-icon ui-icon-check">&nbsp;</span> Curve Grades']=
function(){var d=o(i),n=d.title;I.find(".assignment_title").text(n).end().find(".assignment_id").val(d.assignment_id).end().find(".out_of").showIf(d.points_possible||d.points_possible==="0").end().find("#middle_score").val(parseInt((d.points_possible||0)*0.6,10)).end().find(".points_possible").text(d.points_possible).end().dialog("close").dialog({autoOpen:false,width:350,height:"auto",open:function(){gradebook.curve()}}).dialog("open").dialog("option","title","Curve Grade for "+n)};if(i.hasClass("published"))c['<span class="ui-icon ui-icon-minus">&nbsp;</span> Unpublish Grades']=
function(){var d=i.find(".assignment_link").attr("href");$.ajaxJSON(d,"PUT",{unpublish:true},function(){i.addClass("unpublished").removeClass("published")})};else c['<span class="ui-icon ui-icon-comment">&nbsp;</span> Publish Grades']=function(){var d=i.find(".assignment_link").attr("href");$.ajaxJSON(d,"PUT",{publish:true},function(){i.removeClass("unpublished").addClass("published")})};var l=o(i);if(l.submission_types&&l.submission_types.match(/(online_upload|online_text_entry|online_url)/))c['<span class="ui-icon ui-icon-disk">&nbsp;</span> Download Submissions']=
function(){var d=$(".download_assignment_submissions_url").attr("href");d=$.replaceTags(d,"assignment_id",l.assignment_id);try{object_data["assignment_"+l.assignment_id].assignment.submissions_downloads=(l.submissions_downloads||0)+1}catch(n){}INST.downloadSubmissions(d)};if(l.submissions_downloads&&l.submissions_downloads>0)c['<span class="ui-icon ui-icon-arrowthickstop-1-n">&nbsp;</span> Re-Upload Submissions']=function(){var d=$("#re_upload_submissions_form").find(".re_upload_submissions_url").attr("href");
d=$.replaceTags(d,"assignment_id",l.assignment_id);$("#re_upload_submissions_form").attr("action",d);$("#re_upload_submissions_form").dialog("close").dialog({autoOpen:false,title:"Re-Upload Submission Files",width:350}).dialog("open")}}c['<span class="ui-icon ui-icon-carat-1-w">&nbsp;</span> Hide Column']=function(){datagrid.toggleColumn(datagrid.position(j).column)};if(i.hasClass("group_total")){f=i.find(".assignment_title").text();c['<span class="ui-icon ui-icon-carat-1-w">&nbsp;</span> Hide All '+
f]=function(){var d=o(i).assignment_group_id;$(".outer_assignment_name").each(function(){var n=o($(this)),p=n.assignment_group_id;if(d&&(d=="group-"+p||d==p)){n=datagrid.position($("#assignment_"+n.id).parents(".cell")).column;datagrid.toggleColumn(n,false,true);datagrid.sizeGrid()}})}}$(this).dropdownList({options:c});return false});$("#re_upload_submissions_form").submit(function(){var c=$(this).getFormData();if(c.submissions_zip){if(!c.submissions_zip.match(/\.zip$/)){$(this).formErrors({submissions_zip:"Please upload files as a .zip"});
return false}}else return false});$(document).keycodes("return h i r 1 2 3 4 5 6 7 8 9 0",function(c){if(!(datagrid.currentFocus||!datagrid.currentHover))if(!($(c.target).closest(".ui-dialog").length>0)){var h=datagrid.currentHover;if(c.keyString=="return")h.hasClass("student_assignment")&&datagrid.focus(h.row,h.column);else if(c.keyString=="h")datagrid.toggleColumn(h.column);else if(c.keyString=="i"){c.preventDefault();h.hasClass("student_assignment")&&F(h)}else if(c.keyString=="r")P(false);else h.hasClass("student_assignment")&&
datagrid.focus(h.row,h.column)}});$("#datagrid_data").delegate("#information_link, .new_message, .pending_review","click",function(){F($(this).parents(".student_assignment"));return false});z.find(".add_comment_link").click(function(){$(this).parent().find(".comment_text").css("display","block").focus().select();return false});z.find(".cancel_button").click(function(){z.dialog("close")});z.find(".update_button").click(function(){var c=z.getTemplateData({textValues:["id","student_id","assignment_id"]});
c.comment=z.find("textarea.comment_text").val();c.grade=z.find(".grading_value").val();c.group_comment=z.find("#group_comment_checkbox").attr("checked");L(c,true);z.dialog("close")});$(".refresh_grades_link").click(function(){P(false);return false});setTimeout(function(){P(true)},12E4);$("#hide_students_option").change(function(){var c=$(this).attr("checked");$(".student_name").find(".display_name").showIf(!c).end().find(".hidden_name").showIf(c)}).change();$("#groups_data").find(".group_weight").change(function(){var c=
$(this).parents(".group"),h=c.find(".assignment_group_url").attr("href"),i=c.getFormData(),j={};j["assignment_group[group_weight]"]=i.group_weight;$.ajaxJSON(h,"PUT",j,function(f){c.find(".group_weight").val(f.assignment_group.group_weight);G(true)});G()}).end().find(".cancel_button").click(function(){$("#groups_data").dialog("close")}).end().find("#class_weighting_policy").change(function(){var c=$(".weighting_policy_url").attr("href"),h={},i=$(this).attr("checked"),j=$(this);h["course[group_weighting_scheme]"]=
i?"percent":"equal";$.ajaxJSON(c,"PUT",h,function(f){j.attr("checked",f.course.group_weighting_scheme=="percent");gradebook.pointCalculations=!$("#class_weighting_policy").attr("checked");G(true)})});setTimeout(D,500)},g=navigator.appName,e=parseFloat(navigator.appVersion),r=navigator.productSub||"20070000",s=$("#student_names .outer_student_name").length;if(isNaN(e))e=null;var q=function(){$("#no_students_message, #gradebook_table, .datagrid").addClass("hidden-readable");var c=function(i,j){if(j.length>
1)j=j.substring(1);j=j.replace(/\//g,"_");if(j.indexOf("student")==0||j.indexOf("assignment")==0||j.indexOf("submission")==0){var f=$("#"+j),l=datagrid.position(f.parent());datagrid.scrollTo(l.row,l.column);f.parent().trigger("mouseover")}},h=$("#gradebook_entry_template").html();datagrid.init($("#gradebook_table"),{templateCellHTML:function(i,j){var f=id_maps["row_"+i],l=id_maps["hard_coded_"+j]?"hard_coded":"";return h.replace(/ASSIGNMENT_ID/g,id_maps["column_"+j]).replace(/USER_ID/g,f).replace(/HARD_CODED_CLASS/g,
l)},scroll:function(){J.hide()},onReady:function(){function i(){for(var j=0;j<25;j++){var f=gradebook.queuedSubmissions&&gradebook.queuedSubmissions.shift();f&&t(f)}gradebook.queuedSubmissions&&gradebook.queuedSubmissions.length?setTimeout(i,1):gradebook.makeAccessible()}$(".table_entry.hard_coded .pct").text("%");object_data=object_data||{};object_data.grid=true;$(document).fragmentChange(c);$(document).fragmentChange();setTimeout(i,1)},tick:function(){E.progressbar("option","value",E.progressbar("option",
"value")+25/s)}})};g&&e&&(g.match(r<"20080000")||g.match(/Internet Explorer/)&&e<5)?setTimeout(q,50):q();var m=function(){if(object_data&&object_data.grid&&object_data.assignments&&object_data.students&&!m.initialized){m.initialized=true;setTimeout(b,500)}if(object_data&&object_data.grid&&object_data.assignments&&object_data.students&&object_data.submissions){$("#gradebook_table, .datagrid, #no_students_message").removeClass("hidden-readable");$("#loading_gradebook_message").hide();E.progressbar("option",
"value",E.progressbar("option","value")+50);$(window).triggerHandler("resize");setTimeout(gradebook.populate,1)}else setTimeout(m,1)};setTimeout(m,1);g=function(){function c(){var d=E.progressbar("option","value")||15;if(d<85){d=Math.min(d+1,85);E.progressbar("option","value",d)}}function h(d,n,p){$.ajaxJSON(d,"GET",{},function(u){i++;object_data=object_data||{};if(n=="assignments"){E.progressbar("option","value",E.progressbar("option","value")+10);for(var w in u){gradebook.assignmentIndexes[u[w].assignment.id]=
w+1;object_data["assignment_"+u[w].assignment.id]=u[w]}object_data.assignments=true}else if(n=="students"){E.progressbar("option","value",E.progressbar("option","value")+10);for(w in u){gradebook.studentIndexes[u[w].user.id]=w+1;object_data["student_"+u[w].user.id]=u[w]}object_data.students=true}else{c();for(w in u){object_data["submission_"+u[w].submission.user_id+"_"+u[w].submission.assignment_id]=u[w];t(u[w].submission)}object_data.student_submissions_count=object_data.student_submissions_count||
0;object_data.student_submissions_count+=p||1;if(object_data.student_submissions_count>=(object_data.students_count||1))object_data.submissions=true}},function(){h.errors=h.errors||0;h.errors++;h.errors>10?$("#loading_gradebook_status").text("Gradebook failed to load, please try refreshing the page"):setTimeout(function(){h(d)},50)})}var i=0;E.progressbar("option","value",E.progressbar("option","value")+5);setInterval(function(){i<3&&c()},250);var j=location.href.split("#")[0];j+=location.href.match(/\?/)?
"&":"?";h(j+"init=1&assignments=1","assignments");h(j+"init=1&students=1","students");object_data=object_data||{};object_data.students_count=$("#student_names .outer_student_name").length;var f=Math.round(200/($("#assignment_names .outer_assignment_name").length||1)),l=[];setTimeout(function(){if($("#student_names .outer_student_name .assignment_header").length===0)object_data.submissions=true;else{$("#student_names .outer_student_name .assignment_header").each(function(){var d=($(this).attr("id")||
"").substring(14);d&&l.push(d);if(l.length>f){h(j+"init=1&submissions=1&user_ids="+l.join(","),"student_submissions",l.length);l=[]}});l.length>0&&h(j+"init=1&submissions=1&user_ids="+l.join(","),"student_submissions",l.length)}},1)};if(!object_data||!object_data.pre_initialized)g();else{for(var k in object_data)object_data[k].submission&&t(object_data[k].submission);object_data.assignments=true;object_data.students=true;object_data.submissions=true}setTimeout(function(){gradebook.curve=function(){var c=
0,h={},i=I.getFormData(),j=o($("#assignment_"+i.assignment_id).parent()).points_possible,f=[],l=0,d=parseInt($("#middle_score").val(),10);$(".table_entry.assignment_"+i.assignment_id).each(function(){var U=o($(this).parent());if(U.score||i.assign_blanks)h[U.user_id]=U.score||0});d/=j;if(!isNaN(d)){for(c in h){var n=h[c];if(n>j)n=j;if(n<0)n=0;f[parseInt(n,10)]=f[parseInt(n,10)]||[];f[parseInt(n,10)].push([c,n||0]);l++}var p=[0.0060,0.012,0.028,0.04,0.068,0.106,0.159,0.227,0.309,0.401,0.5,0.599,0.691,
0.773,0.841,0.894,0.933,0.96,0.977,0.988,1];d=(1-d)/Math.floor(p.length/2);var u=[],w=[];for(c=0;c<p.length;c++){w.push(1-d*c);u.push(Math.round((1-d*c)*j))}var x=0;d={};var K=0;$("#results_list").empty();$("#results_values").empty();w=[];for(c=f.length-1;c>=0;c--){var C=f[c]||[];n=Math.round(u[K]);for(var y in C){var Q=C[y];d[Q[0]]=n;if(Q[1]==0)d[Q[0]]=0;finalScore=d[Q[0]];w[finalScore]=w[finalScore]||[];w[finalScore].push(Q[0])}for(x+=C.length;x>p[K]*l;)K++}f=0;for(c=w.length-1;c>=0;c--){l=(w[c]||
[]).length;if(l>f)f=l}y=0;for(c=w.length-1;c>=0;c--){C=w[c];l=p=0;if(C||y>j/10){if(C){p=C.length/f;l=C.length}C=c===0?"#ee8":"#cdf";$("#results_list").prepend("<td style='padding: 1px;'><div title='"+l+" student"+(l==1?"":"s")+" will get "+c+" points' style='border: 1px solid #888; background-color: "+C+"; width: 15px; height: "+100*p+"px; margin-top: "+100*(1-p)+"px;'>&nbsp;</div></td>");$("#results_values").prepend("<td style='text-align: center;'>"+c+"</td>");y=0}else y++}$("#results_list").prepend("<td><div style='height: 100px; position: relative; width: 30px; font-size: 0.8em;'><img src='/images/number_of_students.png' alt='# of students'/><div style='position: absolute; top: 0; right: 3px;'>"+
f+"</div><div style='position: absolute; bottom: 0; right: 3px;'>0</div></div></td>");$("#results_values").prepend("<td>&nbsp;</td>");return d}};$("#middle_score").bind("blur change keyup focus",function(){gradebook.curve()});$("#assign_blanks").change(function(){gradebook.curve()});R.find(".close_button").click(function(){R.dialog("close")});I.formSubmit({processData:function(c){var h=0;curves=gradebook.curve();for(var i in curves){var j="submissions[submission_"+i+"]";c[j+"[assignment_id]"]=c.assignment_id;
c[j+"[user_id]"]=i;c[j+"[grade]"]=curves[i];h++}if(h===0){I.errorBox("None to Update");return false}return c},beforeSubmit:function(){I.loadingImage().find(".cancel_button").attr("disabled",true)},success:function(c){I.loadingImage("remove");for(var h in c){var i=c[h].submission;t(i);O.push(i.user_id)}alert(c.length+" Student scores updated");I.find(".cancel_button").attr("disabled",false).dialog("close")},error:function(){I.loadingImage("remove")}}).find(".cancel_button").click(function(){I.dialog("close")})},
1500)});var O=[];gradebook.finalGradesReady=true;var M={};window.sortStudentRows=function(b){var a=[];$(".outer_student_name").each(function(){var k=$(this).getTemplateData({textValues:["display_name","secondary_identifier","course_section"]});k.display_name=(k.display_name||"zzzzzzz").toLowerCase();k.secondary_identifier=(k.secondary_identifier||"zzzzzzz").toLowerCase();k.course_section=(k.course_section||"zzzzzzz").toLowerCase();k.id=$(this).find(".assignment_header").attr("id").substring(14);k.grade=
parseFloat($(".student_"+k.id+".assignment_final-grade .grade").text())||0;a.push(k)});var g=[],e;for(e in a){var r=a[e],s=b(r);s.student=r;g.push(s)}g=g.sort();a=[];for(e in g)a.push(g[e].student);var q=[0],m=["--"];$.each(a,function(k,c){var h=$("#student_"+c.id).parents(".cell");q.push(datagrid.position(h).row);m.push(h.find(".display_name").text())});datagrid.reorderRows(q)};window.reverseRows=function(){for(var b=[0],a=datagrid.rows.length-1;a>0;a--)b.push(a);datagrid.reorderRows(b)};window.sortAssignmentColumns=
function(b){var a=$(".outer_assignment_name"),g=[],e={};$("#groups_data .group").each(function(c){var h=$(this).find(".assignment_group_id").text();e[h]=c});a.each(function(){var c=$(this).data("assignment_object");c.groupData=e;g.push(c)});a=[];for(var r in g){var s=g[r],q=b(s);q.assignment=s;a.push(q)}a=a.sort();g=[];for(r in a)g.push(a[r].assignment);var m=[0],k=["--"];$.each(g,function(c,h){var i=$("#assignment_"+h.id).parents(".cell");m.push(datagrid.position(i).column);k.push(i.find(".assignment_title").text())});
datagrid.reorderColumns(m)};$(document).ready(function(){$(document).bind("update_student_grades",function(b,a){T(a)})});$.fn.gradebookLoading=function(b){this.find(".refresh_grades_link").find(".static").showIf(b).end().find(".animated").showIf(!b)}})();
(function(){var o=$("#message_students_dialog"),L={};window.messageStudents=function(t){L=t;o.find(".message_types").empty();for(var v in t.options){var A=$("<option/>"),F=t.options[v];A.val(v).text(F.text);o.find(".message_types").append(A)}A=t.title;F=o.find("ul li.blank:first");var D=o.find("ul"),G={};o.find("ul li:not(.blank)").remove();for(v in t.students){var H=F.clone(true).removeClass("blank");H.find(".name").text(t.students[v].name);H.find(".score").text(t.students[v].score);H.data("id",
t.students[v].id);H.user_data=t.students[v];D.append(H.show());G[t.students[v].id]=H}D.show();o.data("students_hash",G);o.find(".asset_title").text(A);o.find(".out_of").showIf(t.points_possible!=null);o.find(".subject").val(A);o.find(".send_button").text("Send Message");o.find(".points_possible").text(t.points_possible);o.find("textarea").val("");o.find("select")[0].selectedIndex=0;o.find("select").change();o.dialog("close").dialog({width:600,height:400}).dialog("open").dialog("option","title","Message Students for "+
A)};$(document).ready(function(){o.find(".cutoff_score").bind("change blur keyup",function(){o.find("select").change()});o.find(".cancel_button").click(function(){o.dialog("close")});$("#message_assignment_recipients").formSubmit({processData:function(t){var v=[];$(this).find(".student:visible").each(function(){v.push($(this).data("id"))});if(v.length==0)return false;t["context_message[recipients]"]=v.join(",");return t},beforeSubmit:function(){$(this).find("button").attr("disabled",true).filter(".send_button").text("Sending Message...")},
success:function(){$(this).find(".send_button").text("Message Sent!");var t=$(this);setTimeout(function(){t.find("button").attr("disabled",false).filter(".send_button").text("Send Message");$("#message_students_dialog").dialog("close")},2E3)},error:function(){$(this).find("button").attr("disabled",false).filter(".send_button").text("Sending Message Failed, please try again")}});o.find("select").change(function(){var t=parseInt($(this).val(),10)||0,v=L.options[t],A=o.data("students_hash"),F=parseFloat(o.find(".cutoff_score").val(),
10)||null,D=null,G=[];for(t in A)G.push(A[t]);if(A)if(v&&v.callback)D=v.callback.call(window.messageStudents,F,G);else if(L.callback)D=L.callback.call(window.messageStudents,v.text,F,G);D=D||[];o.find(".cutoff_holder").showIf(v.cutoff);o.find(".student_list").toggleClass("show_score",v.cutoff||v.score);o.find("button").attr("disabled",D.length==0);v={};for(t in D)v[parseInt(D[t],10)||0]=true;for(t in A)A[t].showIf(v[t])})})})();
